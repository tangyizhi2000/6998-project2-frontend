{"ast":null,"code":"import _slicedToArray from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useRef, useState } from 'react';\nimport InternalAutosuggest from '../autosuggest/internal';\nimport { KeyCode } from '../internal/keycode';\nimport { makeCancellable, PromiseCancelledSignal } from '../internal/utils/promises';\nimport styles from './styles.css.js';\nexport var TagControl = React.forwardRef(function (_ref, ref) {\n  var row = _ref.row,\n    value = _ref.value,\n    readOnly = _ref.readOnly,\n    defaultOptions = _ref.defaultOptions,\n    placeholder = _ref.placeholder,\n    errorText = _ref.errorText,\n    loadingText = _ref.loadingText,\n    suggestionText = _ref.suggestionText,\n    tooManySuggestionText = _ref.tooManySuggestionText,\n    limit = _ref.limit,\n    filteringKey = _ref.filteringKey,\n    enteredTextLabel = _ref.enteredTextLabel,\n    clearAriaLabel = _ref.clearAriaLabel,\n    _onChange = _ref.onChange,\n    _onBlur = _ref.onBlur,\n    onRequest = _ref.onRequest,\n    initialOptionsRef = _ref.initialOptionsRef;\n  var _useState = useState(defaultOptions),\n    _useState2 = _slicedToArray(_useState, 2),\n    options = _useState2[0],\n    setOptions = _useState2[1];\n  var _useState3 = useState(),\n    _useState4 = _slicedToArray(_useState3, 2),\n    statusType = _useState4[0],\n    setStatusType = _useState4[1];\n  var requestCancelFnRef = useRef({\n    cancel: function cancel() {},\n    isCancelled: function isCancelled() {\n      return false;\n    }\n  });\n  var latestFilteringQuery = useRef({\n    key: undefined,\n    value: undefined\n  });\n  var isSameQuery = function isSameQuery(key, value) {\n    return latestFilteringQuery.current.key === key && latestFilteringQuery.current.value === value;\n  };\n  var _onLoadItems = function onLoadItems(filteringText) {\n    if (!onRequest || isSameQuery(filteringKey, filteringText) || requestCancelFnRef.current.isCancelled()) {\n      return;\n    }\n    requestCancelFnRef.current.cancel();\n    if (latestFilteringQuery.current.key !== filteringKey) {\n      // Reset suggestions for values if the key is different.\n      setOptions([]);\n    } else if (filteringText === '' && (initialOptionsRef === null || initialOptionsRef === void 0 ? void 0 : initialOptionsRef.current) && initialOptionsRef.current.length > 0) {\n      // Load in the background, if the value is empty and we already have suggestions.\n      setOptions(initialOptionsRef.current);\n    }\n    setStatusType('loading');\n    latestFilteringQuery.current = {\n      key: filteringKey,\n      value: filteringText\n    };\n    var _makeCancellable = makeCancellable(onRequest(filteringText)),\n      promise = _makeCancellable.promise,\n      cancel = _makeCancellable.cancel,\n      isCancelled = _makeCancellable.isCancelled;\n    promise.then(function (newValues) {\n      var newOptions = newValues.map(function (value) {\n        return {\n          value: value\n        };\n      });\n      setStatusType(undefined);\n      setOptions(newOptions);\n      if (initialOptionsRef) {\n        initialOptionsRef.current = newOptions;\n      }\n    }).catch(function (err) {\n      if (!(err instanceof PromiseCancelledSignal)) {\n        setStatusType('error');\n      }\n    });\n    requestCancelFnRef.current = {\n      cancel: cancel,\n      isCancelled: isCancelled\n    };\n  };\n  return React.createElement(InternalAutosuggest, {\n    ref: ref,\n    value: value,\n    readOnly: readOnly,\n    statusType: statusType,\n    options: options.length < limit ? options : [],\n    empty: options.length < limit ? suggestionText : tooManySuggestionText,\n    placeholder: placeholder,\n    errorText: errorText,\n    loadingText: loadingText,\n    enteredTextLabel: enteredTextLabel,\n    clearAriaLabel: clearAriaLabel,\n    onChange: function onChange(_ref2) {\n      var detail = _ref2.detail;\n      return _onChange(detail.value, row);\n    },\n    onBlur: function onBlur() {\n      return _onBlur === null || _onBlur === void 0 ? void 0 : _onBlur(row);\n    },\n    onFocus: function onFocus() {\n      _onLoadItems('');\n    },\n    onLoadItems: function onLoadItems(_ref3) {\n      var detail = _ref3.detail;\n      _onLoadItems(detail.filteringText);\n    }\n  });\n});\nexport var UndoButton = React.forwardRef(function (_ref4, ref) {\n  var children = _ref4.children,\n    onClick = _ref4.onClick;\n  return React.createElement(\"a\", {\n    ref: ref,\n    role: \"button\",\n    tabIndex: 0,\n    className: styles['undo-button'],\n    onClick: onClick,\n    onKeyDown: function onKeyDown(event) {\n      if (event.keyCode === KeyCode.space || event.keyCode === KeyCode.enter) {\n        event.preventDefault();\n      }\n      // Enter activates the button on key down instead of key up.\n      if (event.keyCode === KeyCode.enter) {\n        onClick();\n      }\n    },\n    onKeyUp: function onKeyUp(event) {\n      // Emulate button behavior, which also fires on space.\n      if (event.keyCode === KeyCode.space) {\n        onClick();\n      }\n    }\n  }, children);\n});","map":{"version":3,"mappings":"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","names":["React","useRef","useState","InternalAutosuggest","KeyCode","makeCancellable","PromiseCancelledSignal","styles","TagControl","forwardRef","ref","row","value","readOnly","defaultOptions","placeholder","errorText","loadingText","suggestionText","tooManySuggestionText","limit","filteringKey","enteredTextLabel","clearAriaLabel","onChange","onBlur","onRequest","initialOptionsRef","options","setOptions","statusType","setStatusType","requestCancelFnRef","cancel","isCancelled","latestFilteringQuery","key","undefined","isSameQuery","current","onLoadItems","filteringText","length","promise","then","newOptions","newValues","map","catch","err","empty","detail","onFocus","UndoButton","children","onClick","role","tabIndex","className","onKeyDown","event","keyCode","space","enter","preventDefault","onKeyUp"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/tag-editor/lib/default/tag-editor/internal.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useRef, useState } from 'react';\n\nimport { AutosuggestProps } from '../autosuggest/interfaces';\nimport InternalAutosuggest from '../autosuggest/internal';\nimport { InputProps } from '../input/interfaces';\nimport { DropdownStatusProps } from '../internal/components/dropdown-status';\n\nimport { KeyCode } from '../internal/keycode';\nimport { makeCancellable, PromiseCancelledSignal } from '../internal/utils/promises';\n\nimport styles from './styles.css.js';\n\ninterface FilteringParams {\n  key?: string;\n  value?: string;\n}\nexport interface TagControlProps {\n  row: number;\n  value: string;\n  readOnly: boolean;\n  defaultOptions: AutosuggestProps.Options;\n  placeholder?: string;\n  errorText?: string;\n  loadingText?: string;\n  suggestionText?: string;\n  tooManySuggestionText?: string;\n  limit: number;\n  filteringKey?: string;\n  clearAriaLabel?: string;\n  enteredTextLabel?: (value: string) => string;\n  onChange: (value: string, row: number) => void;\n  onBlur?: (row: number) => void;\n  onRequest?: (value: string) => Promise<readonly string[]>;\n\n  initialOptionsRef?: React.MutableRefObject<AutosuggestProps.Options>;\n}\n\nexport const TagControl = React.forwardRef(\n  (\n    {\n      row,\n      value,\n      readOnly,\n      defaultOptions,\n      placeholder,\n      errorText,\n      loadingText,\n      suggestionText,\n      tooManySuggestionText,\n      limit,\n      filteringKey,\n      enteredTextLabel,\n      clearAriaLabel,\n      onChange,\n      onBlur,\n      onRequest,\n      initialOptionsRef,\n    }: TagControlProps,\n    ref: React.Ref<InputProps.Ref>\n  ) => {\n    const [options, setOptions] = useState<AutosuggestProps.Options>(defaultOptions);\n    const [statusType, setStatusType] = useState<DropdownStatusProps.StatusType>();\n    const requestCancelFnRef = useRef<{ cancel: () => void; isCancelled: () => boolean }>({\n      cancel: () => {},\n      isCancelled: () => false,\n    });\n\n    const latestFilteringQuery = useRef<FilteringParams>({ key: undefined, value: undefined });\n    const isSameQuery = (key: string | undefined, value: string) =>\n      latestFilteringQuery.current.key === key && latestFilteringQuery.current.value === value;\n\n    const onLoadItems = (filteringText: string) => {\n      if (!onRequest || isSameQuery(filteringKey, filteringText) || requestCancelFnRef.current.isCancelled()) {\n        return;\n      }\n      requestCancelFnRef.current.cancel();\n\n      if (latestFilteringQuery.current.key !== filteringKey) {\n        // Reset suggestions for values if the key is different.\n        setOptions([]);\n      } else if (filteringText === '' && initialOptionsRef?.current && initialOptionsRef.current.length > 0) {\n        // Load in the background, if the value is empty and we already have suggestions.\n        setOptions(initialOptionsRef.current);\n      }\n\n      setStatusType('loading');\n      latestFilteringQuery.current = { key: filteringKey, value: filteringText };\n\n      const { promise, cancel, isCancelled } = makeCancellable(onRequest(filteringText));\n      promise\n        .then(newValues => {\n          const newOptions = newValues.map(value => ({ value }));\n          setStatusType(undefined);\n          setOptions(newOptions);\n          if (initialOptionsRef) {\n            initialOptionsRef.current = newOptions;\n          }\n        })\n        .catch(err => {\n          if (!(err instanceof PromiseCancelledSignal)) {\n            setStatusType('error');\n          }\n        });\n      requestCancelFnRef.current = { cancel, isCancelled };\n    };\n\n    return (\n      <InternalAutosuggest\n        ref={ref}\n        value={value}\n        readOnly={readOnly}\n        statusType={statusType}\n        options={options.length < limit ? options : []}\n        empty={options.length < limit ? suggestionText : tooManySuggestionText}\n        placeholder={placeholder}\n        errorText={errorText}\n        loadingText={loadingText}\n        enteredTextLabel={enteredTextLabel}\n        clearAriaLabel={clearAriaLabel}\n        onChange={({ detail }) => onChange(detail.value, row)}\n        onBlur={() => onBlur?.(row)}\n        onFocus={() => {\n          onLoadItems('');\n        }}\n        onLoadItems={({ detail }) => {\n          onLoadItems(detail.filteringText);\n        }}\n      />\n    );\n  }\n);\n\nexport interface UndoButtonProps {\n  children: React.ReactNode;\n  onClick: () => void;\n}\n\nexport const UndoButton = React.forwardRef(\n  ({ children, onClick }: UndoButtonProps, ref: React.Ref<HTMLAnchorElement>) => {\n    return (\n      <a\n        ref={ref}\n        role=\"button\"\n        tabIndex={0}\n        className={styles['undo-button']}\n        onClick={onClick}\n        onKeyDown={event => {\n          if (event.keyCode === KeyCode.space || event.keyCode === KeyCode.enter) {\n            event.preventDefault();\n          }\n          // Enter activates the button on key down instead of key up.\n          if (event.keyCode === KeyCode.enter) {\n            onClick();\n          }\n        }}\n        onKeyUp={event => {\n          // Emulate button behavior, which also fires on space.\n          if (event.keyCode === KeyCode.space) {\n            onClick();\n          }\n        }}\n      >\n        {children}\n      </a>\n    );\n  }\n);\n"]},"metadata":{},"sourceType":"module"}