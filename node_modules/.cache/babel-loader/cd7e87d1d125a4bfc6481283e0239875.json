{"ast":null,"code":"import _defineProperty from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport { arc } from 'd3-shape';\nimport styles from './styles.css.js';\nimport { balanceLabelNodes, computeSmartAngle } from './utils';\nimport ResponsiveText from './responsive-text';\nimport { useResizeObserver } from '@cloudscape-design/component-toolkit/internal';\nfunction LabelElement(_ref) {\n  var x = _ref.x,\n    y = _ref.y,\n    hideTitles = _ref.hideTitles,\n    hideDescriptions = _ref.hideDescriptions,\n    rightSide = _ref.rightSide,\n    title = _ref.title,\n    description = _ref.description,\n    containerBoundaries = _ref.containerBoundaries;\n  return (\n    // Reset the transform property to prepare for `balanceLabelNodes`.\n    // The dataset attributes are also needed in the function for IE11 support.\n    React.createElement(\"g\", {\n      className: styles['label-text'],\n      transform: \"\",\n      \"data-x\": x,\n      \"data-y\": y\n    }, !hideTitles && React.createElement(ResponsiveText, {\n      x: x,\n      y: y,\n      rightSide: rightSide,\n      containerBoundaries: containerBoundaries\n    }, title), !hideDescriptions && description && React.createElement(ResponsiveText, {\n      x: x,\n      y: y + (hideTitles ? 0 : 18),\n      rightSide: rightSide,\n      className: styles.label__description,\n      containerBoundaries: containerBoundaries\n    }, description))\n  );\n}\nexport default (function (_ref2) {\n  var pieData = _ref2.pieData,\n    dimensions = _ref2.dimensions,\n    highlightedSegment = _ref2.highlightedSegment,\n    segmentDescription = _ref2.segmentDescription,\n    visibleDataSum = _ref2.visibleDataSum,\n    hideTitles = _ref2.hideTitles,\n    hideDescriptions = _ref2.hideDescriptions,\n    containerRef = _ref2.containerRef;\n  var containerBoundaries = useElementBoundaries(containerRef);\n  var shouldOptimizeLabels = containerBoundaries.right - containerBoundaries.left - (dimensions.outerRadius + dimensions.innerLabelPadding) * 2 < 300;\n  var markers = useMemo(function () {\n    var radius = dimensions.outerRadius,\n      innerLabelPadding = dimensions.innerLabelPadding;\n    // More arc factories for the label positioning\n    var arcMarkerStart = arc().innerRadius(radius - 1).outerRadius(radius - 1);\n    var arcMarkerBreak = arc().innerRadius(radius + innerLabelPadding).outerRadius(radius + innerLabelPadding);\n    return pieData.map(function (datum, i) {\n      var labelDatum = pieData[i];\n      var smartAngle = computeSmartAngle(labelDatum.startAngle, labelDatum.endAngle, shouldOptimizeLabels);\n      // Make the marker line longer if the segment is closer to the top or bottom of the chart\n      var lineExtension = 0.5 * Math.cos(2 * smartAngle) + 0.5;\n      arcMarkerBreak.outerRadius(radius + 20 * lineExtension);\n      arcMarkerBreak.innerRadius(radius + 20 * lineExtension);\n      var _arcMarkerStart$centr = arcMarkerStart.centroid(Object.assign(Object.assign({}, datum), {\n          startAngle: smartAngle,\n          endAngle: smartAngle\n        })),\n        _arcMarkerStart$centr2 = _slicedToArray(_arcMarkerStart$centr, 2),\n        startX = _arcMarkerStart$centr2[0],\n        startY = _arcMarkerStart$centr2[1];\n      var _arcMarkerBreak$centr = arcMarkerBreak.centroid(Object.assign(Object.assign({}, datum), {\n          startAngle: smartAngle,\n          endAngle: smartAngle\n        })),\n        _arcMarkerBreak$centr2 = _slicedToArray(_arcMarkerBreak$centr, 2),\n        breakX = _arcMarkerBreak$centr2[0],\n        breakY = _arcMarkerBreak$centr2[1];\n      var rightSide = smartAngle < Math.PI;\n      var endX = shouldOptimizeLabels ? breakX + 20 * (rightSide ? 1 : -1) : (radius + 20) * (rightSide ? 1 : -1);\n      var textX = endX + 5 * (rightSide ? 1 : -1);\n      return {\n        startX: startX,\n        startY: startY,\n        breakX: breakX,\n        breakY: breakY,\n        endX: endX,\n        endY: breakY,\n        textX: textX,\n        textY: breakY,\n        rightSide: rightSide,\n        datum: datum\n      };\n    });\n  }, [pieData, dimensions, shouldOptimizeLabels]);\n  var rootRef = useRef(null);\n  useLayoutEffect(function () {\n    if (!rootRef.current) {\n      return;\n    }\n    // Relax labels that are overlapping\n    var labelNodes = rootRef.current.querySelectorAll(\".\".concat(styles['label-text']));\n    balanceLabelNodes(labelNodes, markers, false, dimensions.outerRadius + dimensions.innerLabelPadding);\n    balanceLabelNodes(labelNodes, markers, true, dimensions.outerRadius + dimensions.innerLabelPadding);\n  }, [markers, pieData, dimensions]);\n  return React.createElement(\"g\", {\n    className: styles.markers,\n    \"aria-hidden\": \"true\",\n    ref: rootRef\n  }, markers.map(function (_ref3) {\n    var _clsx;\n    var startX = _ref3.startX,\n      startY = _ref3.startY,\n      breakX = _ref3.breakX,\n      breakY = _ref3.breakY,\n      endX = _ref3.endX,\n      endY = _ref3.endY,\n      textX = _ref3.textX,\n      textY = _ref3.textY,\n      rightSide = _ref3.rightSide,\n      datum = _ref3.datum;\n    var segment = datum.data.datum;\n    var description = segmentDescription === null || segmentDescription === void 0 ? void 0 : segmentDescription(segment, visibleDataSum);\n    if (hideTitles && !description || hideDescriptions && !segment.title) {\n      return null;\n    }\n    return React.createElement(\"g\", {\n      key: datum.data.index,\n      className: clsx(styles.label, (_clsx = {}, _defineProperty(_clsx, styles['label--highlighted'], highlightedSegment === segment), _defineProperty(_clsx, styles['label--dimmed'], highlightedSegment !== null && highlightedSegment !== segment), _defineProperty(_clsx, styles['label--align-right'], !rightSide), _clsx))\n    }, React.createElement(\"line\", {\n      x1: startX,\n      y1: startY,\n      x2: breakX,\n      y2: breakY\n    }), React.createElement(\"line\", {\n      x1: breakX,\n      y1: breakY,\n      x2: endX,\n      y2: endY,\n      className: styles['label-line']\n    }), React.createElement(LabelElement, {\n      x: textX,\n      y: textY,\n      rightSide: rightSide,\n      title: segment.title,\n      description: description,\n      hideTitles: hideTitles,\n      hideDescriptions: hideDescriptions,\n      containerBoundaries: containerBoundaries\n    }));\n  }));\n});\nfunction useElementBoundaries(ref) {\n  var _useState = useState({\n      left: 0,\n      right: 0\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    state = _useState2[0],\n    setState = _useState2[1];\n  useResizeObserver(ref, function (entry) {\n    var elementRect = entry.target.getBoundingClientRect();\n    setState({\n      left: elementRect.left,\n      right: elementRect.right\n    });\n  });\n  return state;\n}","map":{"version":3,"mappings":"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","names":["React","useLayoutEffect","useMemo","useRef","useState","clsx","arc","styles","balanceLabelNodes","computeSmartAngle","ResponsiveText","useResizeObserver","LabelElement","x","y","hideTitles","hideDescriptions","rightSide","title","description","containerBoundaries","className","transform","label__description","pieData","dimensions","highlightedSegment","segmentDescription","visibleDataSum","containerRef","useElementBoundaries","shouldOptimizeLabels","right","left","outerRadius","innerLabelPadding","markers","radius","arcMarkerStart","innerRadius","arcMarkerBreak","map","datum","i","labelDatum","smartAngle","startAngle","endAngle","lineExtension","Math","cos","centroid","startX","startY","breakX","breakY","PI","endX","textX","endY","textY","rootRef","current","labelNodes","querySelectorAll","ref","segment","data","key","index","label","x1","y1","x2","y2","state","setState","elementRect","entry","target","getBoundingClientRect"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/pie-chart/lib/default/pie-chart/labels.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport { arc, PieArcDatum } from 'd3-shape';\n\nimport { PieChartProps } from './interfaces';\nimport styles from './styles.css.js';\nimport { InternalChartDatum } from './pie-chart';\nimport { Dimension, balanceLabelNodes, computeSmartAngle } from './utils';\nimport ResponsiveText from './responsive-text';\nimport { useResizeObserver } from '@cloudscape-design/component-toolkit/internal';\n\nexport interface LabelsProps<T> {\n  pieData: PieArcDatum<InternalChartDatum<T>>[];\n  visibleDataSum: number;\n  dimensions: Dimension;\n  hideTitles: boolean;\n  hideDescriptions: boolean;\n  highlightedSegment: PieChartProps.Datum | null;\n  segmentDescription?: PieChartProps.SegmentDescriptionFunction<T>;\n  containerRef: React.RefObject<HTMLDivElement>;\n}\n\ninterface LabelElementProps {\n  x: number;\n  y: number;\n  rightSide: boolean;\n  hideTitles: boolean;\n  hideDescriptions: boolean;\n  title: PieChartProps.Datum['title'];\n  description?: string;\n  containerBoundaries: null | { left: number; right: number };\n}\n\nfunction LabelElement({\n  x,\n  y,\n  hideTitles,\n  hideDescriptions,\n  rightSide,\n  title,\n  description,\n  containerBoundaries,\n}: LabelElementProps) {\n  return (\n    // Reset the transform property to prepare for `balanceLabelNodes`.\n    // The dataset attributes are also needed in the function for IE11 support.\n    <g className={styles['label-text']} transform=\"\" data-x={x} data-y={y}>\n      {!hideTitles && (\n        <ResponsiveText x={x} y={y} rightSide={rightSide} containerBoundaries={containerBoundaries}>\n          {title}\n        </ResponsiveText>\n      )}\n      {!hideDescriptions && description && (\n        <ResponsiveText\n          x={x}\n          y={y + (hideTitles ? 0 : 18)}\n          rightSide={rightSide}\n          className={styles.label__description}\n          containerBoundaries={containerBoundaries}\n        >\n          {description}\n        </ResponsiveText>\n      )}\n    </g>\n  );\n}\n\nexport default <T extends PieChartProps.Datum>({\n  pieData,\n  dimensions,\n  highlightedSegment,\n  segmentDescription,\n  visibleDataSum,\n  hideTitles,\n  hideDescriptions,\n  containerRef,\n}: LabelsProps<T>) => {\n  const containerBoundaries = useElementBoundaries(containerRef);\n  const shouldOptimizeLabels =\n    containerBoundaries.right - containerBoundaries.left - (dimensions.outerRadius + dimensions.innerLabelPadding) * 2 <\n    300;\n  const markers = useMemo(() => {\n    const { outerRadius: radius, innerLabelPadding } = dimensions;\n\n    // More arc factories for the label positioning\n    const arcMarkerStart = arc<PieArcDatum<any>>()\n      .innerRadius(radius - 1)\n      .outerRadius(radius - 1);\n\n    const arcMarkerBreak = arc<PieArcDatum<any>>()\n      .innerRadius(radius + innerLabelPadding)\n      .outerRadius(radius + innerLabelPadding);\n\n    return pieData.map((datum, i) => {\n      const labelDatum = pieData[i];\n      const smartAngle = computeSmartAngle(labelDatum.startAngle, labelDatum.endAngle, shouldOptimizeLabels);\n\n      // Make the marker line longer if the segment is closer to the top or bottom of the chart\n      const lineExtension = 0.5 * Math.cos(2 * smartAngle) + 0.5;\n      arcMarkerBreak.outerRadius(radius + 20 * lineExtension);\n      arcMarkerBreak.innerRadius(radius + 20 * lineExtension);\n      const [startX, startY] = arcMarkerStart.centroid({ ...datum, startAngle: smartAngle, endAngle: smartAngle });\n      const [breakX, breakY] = arcMarkerBreak.centroid({ ...datum, startAngle: smartAngle, endAngle: smartAngle });\n\n      const rightSide = smartAngle < Math.PI;\n      const endX = shouldOptimizeLabels ? breakX + 20 * (rightSide ? 1 : -1) : (radius + 20) * (rightSide ? 1 : -1);\n      const textX = endX + 5 * (rightSide ? 1 : -1);\n\n      return {\n        startX,\n        startY,\n        breakX,\n        breakY,\n        endX,\n        endY: breakY,\n        textX,\n        textY: breakY,\n        rightSide,\n        datum,\n      };\n    });\n  }, [pieData, dimensions, shouldOptimizeLabels]);\n\n  const rootRef = useRef<SVGGElement>(null);\n\n  useLayoutEffect(() => {\n    if (!rootRef.current) {\n      return;\n    }\n\n    // Relax labels that are overlapping\n    const labelNodes = rootRef.current.querySelectorAll<SVGGElement>(`.${styles['label-text']}`);\n    balanceLabelNodes(labelNodes, markers, false, dimensions.outerRadius + dimensions.innerLabelPadding);\n    balanceLabelNodes(labelNodes, markers, true, dimensions.outerRadius + dimensions.innerLabelPadding);\n  }, [markers, pieData, dimensions]);\n\n  return (\n    <g className={styles.markers} aria-hidden=\"true\" ref={rootRef}>\n      {markers.map(({ startX, startY, breakX, breakY, endX, endY, textX, textY, rightSide, datum }) => {\n        const segment = datum.data.datum;\n        const description = segmentDescription?.(segment, visibleDataSum);\n        if ((hideTitles && !description) || (hideDescriptions && !segment.title)) {\n          return null;\n        }\n        return (\n          <g\n            key={datum.data.index}\n            className={clsx(styles.label, {\n              [styles['label--highlighted']]: highlightedSegment === segment,\n              [styles['label--dimmed']]: highlightedSegment !== null && highlightedSegment !== segment,\n              [styles['label--align-right']]: !rightSide,\n            })}\n          >\n            <line x1={startX} y1={startY} x2={breakX} y2={breakY} />\n            <line x1={breakX} y1={breakY} x2={endX} y2={endY} className={styles['label-line']} />\n            <LabelElement\n              x={textX}\n              y={textY}\n              rightSide={rightSide}\n              title={segment.title}\n              description={description}\n              hideTitles={hideTitles}\n              hideDescriptions={hideDescriptions}\n              containerBoundaries={containerBoundaries}\n            />\n          </g>\n        );\n      })}\n    </g>\n  );\n};\n\nfunction useElementBoundaries(ref: React.RefObject<HTMLElement>): { left: number; right: number } {\n  const [state, setState] = useState({ left: 0, right: 0 });\n  useResizeObserver(ref, entry => {\n    const elementRect = entry.target.getBoundingClientRect();\n    setState({ left: elementRect.left, right: elementRect.right });\n  });\n  return state;\n}\n"]},"metadata":{},"sourceType":"module"}