{"ast":null,"code":"import _slicedToArray from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { __rest } from \"tslib\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useRef } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport { warnOnce } from '@cloudscape-design/component-toolkit/internal';\nimport { useContainerBreakpoints } from '../internal/hooks/container-queries';\nimport { useControllable } from '../internal/hooks/use-controllable';\nimport { useMergeRefs } from '../internal/hooks/use-merge-refs';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\nimport { useInternalI18n } from '../i18n/context';\nimport { FunnelMetrics } from '../internal/analytics';\nimport { useFunnel } from '../internal/analytics/hooks/use-funnel';\nimport { getNameFromSelector, getSubStepAllSelector } from '../internal/analytics/selectors';\nimport WizardForm, { STEP_NAME_SELECTOR } from './wizard-form';\nimport WizardNavigation from './wizard-navigation';\nimport styles from './styles.css.js';\nimport { useFunnelChangeEvent } from './analytics';\nexport default function InternalWizard(_a) {\n  var _b, _c, _d, _e, _f, _g, _h, _j;\n  var steps = _a.steps,\n    controlledActiveStepIndex = _a.activeStepIndex,\n    submitButtonText = _a.submitButtonText,\n    _a$isLoadingNextStep = _a.isLoadingNextStep,\n    isLoadingNextStep = _a$isLoadingNextStep === void 0 ? false : _a$isLoadingNextStep,\n    _a$allowSkipTo = _a.allowSkipTo,\n    allowSkipTo = _a$allowSkipTo === void 0 ? false : _a$allowSkipTo,\n    secondaryActions = _a.secondaryActions,\n    onCancel = _a.onCancel,\n    onSubmit = _a.onSubmit,\n    onNavigate = _a.onNavigate,\n    __internalRootRef = _a.__internalRootRef,\n    rest = __rest(_a, [\"steps\", \"activeStepIndex\", \"submitButtonText\", \"isLoadingNextStep\", \"allowSkipTo\", \"secondaryActions\", \"onCancel\", \"onSubmit\", \"onNavigate\", \"__internalRootRef\"]);\n  var baseProps = getBaseProps(rest);\n  var _useContainerBreakpoi = useContainerBreakpoints(['xs']),\n    _useContainerBreakpoi2 = _slicedToArray(_useContainerBreakpoi, 2),\n    breakpoint = _useContainerBreakpoi2[0],\n    breakpointsRef = _useContainerBreakpoi2[1];\n  var ref = useMergeRefs(breakpointsRef, __internalRootRef);\n  var smallContainer = breakpoint === 'default';\n  var _useControllable = useControllable(controlledActiveStepIndex, onNavigate, 0, {\n      componentName: 'Wizard',\n      controlledProp: 'activeStepIndex',\n      changeHandler: 'onNavigate'\n    }),\n    _useControllable2 = _slicedToArray(_useControllable, 2),\n    activeStepIndex = _useControllable2[0],\n    setActiveStepIndex = _useControllable2[1];\n  var _useFunnel = useFunnel(),\n    funnelInteractionId = _useFunnel.funnelInteractionId,\n    funnelSubmit = _useFunnel.funnelSubmit,\n    funnelCancel = _useFunnel.funnelCancel,\n    funnelProps = _useFunnel.funnelProps,\n    funnelNextOrSubmitAttempt = _useFunnel.funnelNextOrSubmitAttempt;\n  var actualActiveStepIndex = activeStepIndex ? Math.min(activeStepIndex, steps.length - 1) : 0;\n  var farthestStepIndex = useRef(actualActiveStepIndex);\n  farthestStepIndex.current = Math.max(farthestStepIndex.current, actualActiveStepIndex);\n  var isVisualRefresh = useVisualRefresh();\n  var isLastStep = actualActiveStepIndex >= steps.length - 1;\n  var navigationEvent = function navigationEvent(requestedStepIndex, reason) {\n    if (funnelInteractionId) {\n      var stepName = getNameFromSelector(STEP_NAME_SELECTOR);\n      FunnelMetrics.funnelStepNavigation({\n        navigationType: reason,\n        funnelInteractionId: funnelInteractionId,\n        stepNumber: actualActiveStepIndex + 1,\n        stepName: stepName,\n        stepNameSelector: STEP_NAME_SELECTOR,\n        destinationStepNumber: requestedStepIndex + 1,\n        subStepAllSelector: getSubStepAllSelector()\n      });\n    }\n    setActiveStepIndex(requestedStepIndex);\n    fireNonCancelableEvent(onNavigate, {\n      requestedStepIndex: requestedStepIndex,\n      reason: reason\n    });\n  };\n  var onStepClick = function onStepClick(stepIndex) {\n    return navigationEvent(stepIndex, 'step');\n  };\n  var onSkipToClick = function onSkipToClick(stepIndex) {\n    return navigationEvent(stepIndex, 'skip');\n  };\n  var onCancelClick = function onCancelClick() {\n    funnelCancel();\n    fireNonCancelableEvent(onCancel);\n  };\n  var onPreviousClick = function onPreviousClick() {\n    return navigationEvent(actualActiveStepIndex - 1, 'previous');\n  };\n  var onPrimaryClick = function onPrimaryClick() {\n    funnelNextOrSubmitAttempt();\n    if (isLastStep) {\n      funnelSubmit();\n      fireNonCancelableEvent(onSubmit);\n    } else {\n      navigationEvent(actualActiveStepIndex + 1, 'next');\n    }\n  };\n  useFunnelChangeEvent(funnelInteractionId, steps);\n  var i18n = useInternalI18n('wizard');\n  var skipToButtonLabel = i18n('i18nStrings.skipToButtonLabel', (_b = rest.i18nStrings) === null || _b === void 0 ? void 0 : _b.skipToButtonLabel, function (format) {\n    return function (task) {\n      return format({\n        task__title: task.title\n      });\n    };\n  });\n  var i18nStrings = Object.assign(Object.assign({}, rest.i18nStrings), {\n    skipToButtonLabel: skipToButtonLabel,\n    stepNumberLabel: i18n('i18nStrings.stepNumberLabel', (_c = rest.i18nStrings) === null || _c === void 0 ? void 0 : _c.stepNumberLabel, function (format) {\n      return function (stepNumber) {\n        return format({\n          stepNumber: stepNumber\n        });\n      };\n    }),\n    collapsedStepsLabel: i18n('i18nStrings.collapsedStepsLabel', (_d = rest.i18nStrings) === null || _d === void 0 ? void 0 : _d.collapsedStepsLabel, function (format) {\n      return function (stepNumber, stepsCount) {\n        return format({\n          stepNumber: stepNumber,\n          stepsCount: stepsCount\n        });\n      };\n    }),\n    navigationAriaLabel: i18n('i18nStrings.navigationAriaLabel', (_e = rest.i18nStrings) === null || _e === void 0 ? void 0 : _e.navigationAriaLabel),\n    cancelButton: i18n('i18nStrings.cancelButton', (_f = rest.i18nStrings) === null || _f === void 0 ? void 0 : _f.cancelButton),\n    previousButton: i18n('i18nStrings.previousButton', (_g = rest.i18nStrings) === null || _g === void 0 ? void 0 : _g.previousButton),\n    nextButton: i18n('i18nStrings.nextButton', (_h = rest.i18nStrings) === null || _h === void 0 ? void 0 : _h.nextButton),\n    optional: i18n('i18nStrings.optional', (_j = rest.i18nStrings) === null || _j === void 0 ? void 0 : _j.optional)\n  });\n  if (activeStepIndex && activeStepIndex >= steps.length) {\n    warnOnce('Wizard', \"You have set `activeStepIndex` to \".concat(activeStepIndex, \" but you have provided only \").concat(steps.length, \" steps. Its value is ignored and the component uses \").concat(steps.length - 1, \" instead.\"));\n  }\n  if (allowSkipTo && !skipToButtonLabel) {\n    warnOnce('Wizard', \"You have set `allowSkipTo` but you have not provided `i18nStrings.skipToButtonLabel`. The skip-to button will not be rendered.\");\n  }\n  return React.createElement(\"div\", Object.assign({}, baseProps, funnelProps, {\n    ref: ref,\n    className: clsx(styles.root, baseProps.className)\n  }), React.createElement(\"div\", {\n    className: clsx(styles.wizard, isVisualRefresh && styles.refresh, smallContainer && styles['small-container'])\n  }, React.createElement(WizardNavigation, {\n    activeStepIndex: actualActiveStepIndex,\n    farthestStepIndex: farthestStepIndex.current,\n    allowSkipTo: allowSkipTo,\n    hidden: smallContainer,\n    i18nStrings: i18nStrings,\n    isVisualRefresh: isVisualRefresh,\n    isLoadingNextStep: isLoadingNextStep,\n    onStepClick: onStepClick,\n    onSkipToClick: onSkipToClick,\n    steps: steps\n  }), React.createElement(\"div\", {\n    className: clsx(styles.form, isVisualRefresh && styles.refresh, smallContainer && styles['small-container'])\n  }, isVisualRefresh && React.createElement(\"div\", {\n    className: clsx(styles.background, 'awsui-context-content-header')\n  }), React.createElement(WizardForm, {\n    steps: steps,\n    isVisualRefresh: isVisualRefresh,\n    showCollapsedSteps: smallContainer,\n    i18nStrings: i18nStrings,\n    submitButtonText: submitButtonText,\n    activeStepIndex: actualActiveStepIndex,\n    isPrimaryLoading: isLoadingNextStep,\n    allowSkipTo: allowSkipTo,\n    secondaryActions: secondaryActions,\n    onCancelClick: onCancelClick,\n    onPreviousClick: onPreviousClick,\n    onSkipToClick: onSkipToClick,\n    onPrimaryClick: onPrimaryClick\n  }))));\n}","map":{"version":3,"mappings":"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","names":["React","useRef","clsx","getBaseProps","fireNonCancelableEvent","warnOnce","useContainerBreakpoints","useControllable","useMergeRefs","useVisualRefresh","useInternalI18n","FunnelMetrics","useFunnel","getNameFromSelector","getSubStepAllSelector","WizardForm","STEP_NAME_SELECTOR","WizardNavigation","styles","useFunnelChangeEvent","InternalWizard","_a","steps","controlledActiveStepIndex","activeStepIndex","submitButtonText","isLoadingNextStep","allowSkipTo","secondaryActions","onCancel","onSubmit","onNavigate","__internalRootRef","rest","baseProps","breakpoint","breakpointsRef","ref","smallContainer","componentName","controlledProp","changeHandler","setActiveStepIndex","funnelInteractionId","funnelSubmit","funnelCancel","funnelProps","funnelNextOrSubmitAttempt","actualActiveStepIndex","Math","min","length","farthestStepIndex","current","max","isVisualRefresh","isLastStep","navigationEvent","requestedStepIndex","reason","stepName","funnelStepNavigation","navigationType","stepNumber","stepNameSelector","destinationStepNumber","subStepAllSelector","onStepClick","stepIndex","onSkipToClick","onCancelClick","onPreviousClick","onPrimaryClick","i18n","skipToButtonLabel","i18nStrings","format","task__title","task","title","stepNumberLabel","collapsedStepsLabel","stepsCount","navigationAriaLabel","cancelButton","previousButton","nextButton","optional","className","root","wizard","refresh","hidden","form","background","showCollapsedSteps","isPrimaryLoading"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/wizard/lib/default/wizard/internal.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useRef } from 'react';\nimport clsx from 'clsx';\n\nimport { getBaseProps } from '../internal/base-component';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport { warnOnce } from '@cloudscape-design/component-toolkit/internal';\n\nimport { useContainerBreakpoints } from '../internal/hooks/container-queries';\nimport { useControllable } from '../internal/hooks/use-controllable';\nimport { useMergeRefs } from '../internal/hooks/use-merge-refs';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\nimport { InternalBaseComponentProps } from '../internal/hooks/use-base-component';\n\nimport { useInternalI18n } from '../i18n/context';\n\nimport { FunnelMetrics } from '../internal/analytics';\nimport { useFunnel } from '../internal/analytics/hooks/use-funnel';\nimport { getNameFromSelector, getSubStepAllSelector } from '../internal/analytics/selectors';\n\nimport WizardForm, { STEP_NAME_SELECTOR } from './wizard-form';\nimport WizardNavigation from './wizard-navigation';\n\nimport { WizardProps } from './interfaces';\n\nimport styles from './styles.css.js';\nimport { useFunnelChangeEvent } from './analytics';\n\ntype InternalWizardProps = WizardProps & InternalBaseComponentProps;\n\nexport default function InternalWizard({\n  steps,\n  activeStepIndex: controlledActiveStepIndex,\n  submitButtonText,\n  isLoadingNextStep = false,\n  allowSkipTo = false,\n  secondaryActions,\n  onCancel,\n  onSubmit,\n  onNavigate,\n  __internalRootRef,\n  ...rest\n}: InternalWizardProps) {\n  const baseProps = getBaseProps(rest);\n\n  const [breakpoint, breakpointsRef] = useContainerBreakpoints(['xs']);\n  const ref = useMergeRefs(breakpointsRef, __internalRootRef);\n\n  const smallContainer = breakpoint === 'default';\n\n  const [activeStepIndex, setActiveStepIndex] = useControllable(controlledActiveStepIndex, onNavigate, 0, {\n    componentName: 'Wizard',\n    controlledProp: 'activeStepIndex',\n    changeHandler: 'onNavigate',\n  });\n  const { funnelInteractionId, funnelSubmit, funnelCancel, funnelProps, funnelNextOrSubmitAttempt } = useFunnel();\n  const actualActiveStepIndex = activeStepIndex ? Math.min(activeStepIndex, steps.length - 1) : 0;\n\n  const farthestStepIndex = useRef<number>(actualActiveStepIndex);\n  farthestStepIndex.current = Math.max(farthestStepIndex.current, actualActiveStepIndex);\n\n  const isVisualRefresh = useVisualRefresh();\n  const isLastStep = actualActiveStepIndex >= steps.length - 1;\n\n  const navigationEvent = (requestedStepIndex: number, reason: WizardProps.NavigationReason) => {\n    if (funnelInteractionId) {\n      const stepName = getNameFromSelector(STEP_NAME_SELECTOR);\n\n      FunnelMetrics.funnelStepNavigation({\n        navigationType: reason,\n        funnelInteractionId,\n        stepNumber: actualActiveStepIndex + 1,\n        stepName,\n        stepNameSelector: STEP_NAME_SELECTOR,\n        destinationStepNumber: requestedStepIndex + 1,\n        subStepAllSelector: getSubStepAllSelector(),\n      });\n    }\n\n    setActiveStepIndex(requestedStepIndex);\n    fireNonCancelableEvent(onNavigate, { requestedStepIndex, reason });\n  };\n  const onStepClick = (stepIndex: number) => navigationEvent(stepIndex, 'step');\n  const onSkipToClick = (stepIndex: number) => navigationEvent(stepIndex, 'skip');\n  const onCancelClick = () => {\n    funnelCancel();\n    fireNonCancelableEvent(onCancel);\n  };\n  const onPreviousClick = () => navigationEvent(actualActiveStepIndex - 1, 'previous');\n  const onPrimaryClick = () => {\n    funnelNextOrSubmitAttempt();\n\n    if (isLastStep) {\n      funnelSubmit();\n      fireNonCancelableEvent(onSubmit);\n    } else {\n      navigationEvent(actualActiveStepIndex + 1, 'next');\n    }\n  };\n\n  useFunnelChangeEvent(funnelInteractionId, steps);\n\n  const i18n = useInternalI18n('wizard');\n  const skipToButtonLabel = i18n(\n    'i18nStrings.skipToButtonLabel',\n    rest.i18nStrings?.skipToButtonLabel,\n    format => task => format({ task__title: task.title })\n  );\n\n  const i18nStrings: WizardProps.I18nStrings = {\n    ...rest.i18nStrings,\n    skipToButtonLabel,\n    stepNumberLabel: i18n(\n      'i18nStrings.stepNumberLabel',\n      rest.i18nStrings?.stepNumberLabel,\n      format => stepNumber => format({ stepNumber })\n    ),\n    collapsedStepsLabel: i18n(\n      'i18nStrings.collapsedStepsLabel',\n      rest.i18nStrings?.collapsedStepsLabel,\n      format => (stepNumber, stepsCount) => format({ stepNumber, stepsCount })\n    ),\n    navigationAriaLabel: i18n('i18nStrings.navigationAriaLabel', rest.i18nStrings?.navigationAriaLabel),\n    cancelButton: i18n('i18nStrings.cancelButton', rest.i18nStrings?.cancelButton),\n    previousButton: i18n('i18nStrings.previousButton', rest.i18nStrings?.previousButton),\n    nextButton: i18n('i18nStrings.nextButton', rest.i18nStrings?.nextButton),\n    optional: i18n('i18nStrings.optional', rest.i18nStrings?.optional),\n  };\n\n  if (activeStepIndex && activeStepIndex >= steps.length) {\n    warnOnce(\n      'Wizard',\n      `You have set \\`activeStepIndex\\` to ${activeStepIndex} but you have provided only ${\n        steps.length\n      } steps. Its value is ignored and the component uses ${steps.length - 1} instead.`\n    );\n  }\n\n  if (allowSkipTo && !skipToButtonLabel) {\n    warnOnce(\n      'Wizard',\n      `You have set \\`allowSkipTo\\` but you have not provided \\`i18nStrings.skipToButtonLabel\\`. The skip-to button will not be rendered.`\n    );\n  }\n\n  return (\n    <div {...baseProps} {...funnelProps} ref={ref} className={clsx(styles.root, baseProps.className)}>\n      <div\n        className={clsx(styles.wizard, isVisualRefresh && styles.refresh, smallContainer && styles['small-container'])}\n      >\n        <WizardNavigation\n          activeStepIndex={actualActiveStepIndex}\n          farthestStepIndex={farthestStepIndex.current}\n          allowSkipTo={allowSkipTo}\n          hidden={smallContainer}\n          i18nStrings={i18nStrings}\n          isVisualRefresh={isVisualRefresh}\n          isLoadingNextStep={isLoadingNextStep}\n          onStepClick={onStepClick}\n          onSkipToClick={onSkipToClick}\n          steps={steps}\n        />\n        <div\n          className={clsx(styles.form, isVisualRefresh && styles.refresh, smallContainer && styles['small-container'])}\n        >\n          {isVisualRefresh && <div className={clsx(styles.background, 'awsui-context-content-header')} />}\n          <WizardForm\n            steps={steps}\n            isVisualRefresh={isVisualRefresh}\n            showCollapsedSteps={smallContainer}\n            i18nStrings={i18nStrings}\n            submitButtonText={submitButtonText}\n            activeStepIndex={actualActiveStepIndex}\n            isPrimaryLoading={isLoadingNextStep}\n            allowSkipTo={allowSkipTo}\n            secondaryActions={secondaryActions}\n            onCancelClick={onCancelClick}\n            onPreviousClick={onPreviousClick}\n            onSkipToClick={onSkipToClick}\n            onPrimaryClick={onPrimaryClick}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}