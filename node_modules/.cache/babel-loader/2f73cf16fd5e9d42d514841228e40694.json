{"ast":null,"code":"import _slicedToArray from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/regenerator/index.js\";\nimport { __awaiter } from \"tslib\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect, useRef, useState } from 'react';\nimport Button from '../../button/internal';\nimport FormField from '../../form-field/internal';\nimport SpaceBetween from '../../space-between/internal';\nimport { useClickAway } from './click-away';\nimport styles from './styles.css.js';\nimport FocusLock from '../../internal/components/focus-lock';\nimport LiveRegion from '../../internal/components/live-region';\nimport { useInternalI18n } from '../../i18n/context';\n// A function that does nothing\nvar noop = function noop() {\n  return undefined;\n};\nexport function InlineEditor(_ref) {\n  var ariaLabels = _ref.ariaLabels,\n    item = _ref.item,\n    column = _ref.column,\n    onEditEnd = _ref.onEditEnd,\n    submitEdit = _ref.submitEdit,\n    __onRender = _ref.__onRender;\n  var _a, _b, _c, _d;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    currentEditLoading = _useState2[0],\n    setCurrentEditLoading = _useState2[1];\n  var _useState3 = useState(),\n    _useState4 = _slicedToArray(_useState3, 2),\n    currentEditValue = _useState4[0],\n    setCurrentEditValue = _useState4[1];\n  var i18n = useInternalI18n('table');\n  var focusLockRef = useRef(null);\n  var cellContext = {\n    currentValue: currentEditValue,\n    setValue: setCurrentEditValue\n  };\n  function finishEdit() {\n    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref2$cancelled = _ref2.cancelled,\n      cancelled = _ref2$cancelled === void 0 ? false : _ref2$cancelled,\n      _ref2$refocusCell = _ref2.refocusCell,\n      refocusCell = _ref2$refocusCell === void 0 ? true : _ref2$refocusCell;\n    if (!cancelled) {\n      setCurrentEditValue(undefined);\n    }\n    onEditEnd({\n      cancelled: cancelled,\n      refocusCell: refocusCell\n    });\n  }\n  function onSubmitClick(evt) {\n    var _a;\n    return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              evt.preventDefault();\n              if (!(currentEditValue === undefined)) {\n                _context.next = 4;\n                break;\n              }\n              finishEdit();\n              return _context.abrupt(\"return\");\n            case 4:\n              setCurrentEditLoading(true);\n              _context.prev = 5;\n              _context.next = 8;\n              return submitEdit(item, column, currentEditValue);\n            case 8:\n              setCurrentEditLoading(false);\n              finishEdit();\n              _context.next = 16;\n              break;\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](5);\n              setCurrentEditLoading(false);\n              (_a = focusLockRef.current) === null || _a === void 0 ? void 0 : _a.focusFirst();\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 12]]);\n    }));\n  }\n  function onCancel() {\n    var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref3$reFocusEditedCe = _ref3.reFocusEditedCell,\n      reFocusEditedCell = _ref3$reFocusEditedCe === void 0 ? true : _ref3$reFocusEditedCe;\n    if (currentEditLoading) {\n      return;\n    }\n    finishEdit({\n      cancelled: true,\n      refocusCell: reFocusEditedCell\n    });\n  }\n  function handleEscape(event) {\n    if (event.key === 'Escape') {\n      onCancel();\n    }\n  }\n  var clickAwayRef = useClickAway(function () {\n    return onCancel({\n      reFocusEditedCell: false\n    });\n  });\n  useEffect(function () {\n    if (__onRender) {\n      var timer = setTimeout(__onRender, 1);\n      return function () {\n        return clearTimeout(timer);\n      };\n    }\n  }, [__onRender]);\n  // asserting non-undefined editConfig here because this component is unreachable otherwise\n  var _column$editConfig = column.editConfig,\n    _column$editConfig$ar = _column$editConfig.ariaLabel,\n    ariaLabel = _column$editConfig$ar === void 0 ? undefined : _column$editConfig$ar,\n    _column$editConfig$va = _column$editConfig.validation,\n    validation = _column$editConfig$va === void 0 ? noop : _column$editConfig$va,\n    errorIconAriaLabel = _column$editConfig.errorIconAriaLabel,\n    constraintText = _column$editConfig.constraintText,\n    editingCell = _column$editConfig.editingCell;\n  return React.createElement(FocusLock, {\n    restoreFocus: true,\n    ref: focusLockRef\n  }, React.createElement(\"div\", {\n    role: \"dialog\",\n    ref: clickAwayRef,\n    \"aria-label\": (_a = ariaLabels === null || ariaLabels === void 0 ? void 0 : ariaLabels.activateEditLabel) === null || _a === void 0 ? void 0 : _a.call(ariaLabels, column, item),\n    onKeyDown: handleEscape\n  }, React.createElement(\"form\", {\n    onSubmit: onSubmitClick,\n    className: styles['body-cell-editor-form']\n  }, React.createElement(FormField, {\n    stretch: true,\n    label: ariaLabel,\n    constraintText: constraintText,\n    __hideLabel: true,\n    __disableGutters: true,\n    i18nStrings: {\n      errorIconAriaLabel: errorIconAriaLabel\n    },\n    errorText: validation(item, currentEditValue)\n  }, React.createElement(\"div\", {\n    className: styles['body-cell-editor-row']\n  }, editingCell(item, cellContext), React.createElement(\"span\", {\n    className: styles['body-cell-editor-controls']\n  }, React.createElement(SpaceBetween, {\n    direction: \"horizontal\",\n    size: \"xxs\"\n  }, !currentEditLoading ? React.createElement(Button, {\n    ariaLabel: (_b = ariaLabels === null || ariaLabels === void 0 ? void 0 : ariaLabels.cancelEditLabel) === null || _b === void 0 ? void 0 : _b.call(ariaLabels, column),\n    formAction: \"none\",\n    iconName: \"close\",\n    variant: \"inline-icon\",\n    onClick: function onClick() {\n      return onCancel();\n    }\n  }) : null, React.createElement(Button, {\n    ariaLabel: (_c = ariaLabels === null || ariaLabels === void 0 ? void 0 : ariaLabels.submitEditLabel) === null || _c === void 0 ? void 0 : _c.call(ariaLabels, column),\n    formAction: \"submit\",\n    iconName: \"check\",\n    variant: \"inline-icon\",\n    loading: currentEditLoading\n  })), React.createElement(LiveRegion, null, currentEditLoading ? i18n('ariaLabels.submittingEditText', (_d = ariaLabels === null || ariaLabels === void 0 ? void 0 : ariaLabels.submittingEditText) === null || _d === void 0 ? void 0 : _d.call(ariaLabels, column)) : '')))))));\n}","map":{"version":3,"mappings":"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","names":["React","useEffect","useRef","useState","Button","FormField","SpaceBetween","useClickAway","styles","FocusLock","LiveRegion","useInternalI18n","noop","undefined","InlineEditor","ariaLabels","item","column","onEditEnd","submitEdit","__onRender","currentEditLoading","setCurrentEditLoading","currentEditValue","setCurrentEditValue","i18n","focusLockRef","cellContext","currentValue","setValue","finishEdit","cancelled","refocusCell","onSubmitClick","evt","preventDefault","current","focusFirst","onCancel","reFocusEditedCell","handleEscape","event","key","clickAwayRef","timer","setTimeout","clearTimeout","editConfig","ariaLabel","validation","errorIconAriaLabel","constraintText","editingCell","restoreFocus","ref","role","activateEditLabel","onKeyDown","onSubmit","className","stretch","label","__hideLabel","__disableGutters","i18nStrings","errorText","direction","size","cancelEditLabel","formAction","iconName","variant","onClick","submitEditLabel","loading","submittingEditText"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/table/body-cell/lib/default/table/body-cell/inline-editor.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect, useRef, useState } from 'react';\nimport Button from '../../button/internal';\nimport FormField from '../../form-field/internal';\nimport SpaceBetween from '../../space-between/internal';\nimport { useClickAway } from './click-away';\nimport { TableProps } from '../interfaces';\nimport styles from './styles.css.js';\nimport { Optional } from '../../internal/types';\nimport FocusLock, { FocusLockRef } from '../../internal/components/focus-lock';\nimport LiveRegion from '../../internal/components/live-region';\nimport { useInternalI18n } from '../../i18n/context';\n\n// A function that does nothing\nconst noop = () => undefined;\n\ninterface OnEditEndOptions {\n  cancelled: boolean;\n  refocusCell: boolean;\n}\n\ninterface InlineEditorProps<ItemType> {\n  ariaLabels: TableProps['ariaLabels'];\n  column: TableProps.ColumnDefinition<ItemType>;\n  item: ItemType;\n  onEditEnd: (options: OnEditEndOptions) => void;\n  submitEdit: TableProps.SubmitEditFunction<ItemType>;\n  __onRender?: () => void;\n}\n\nexport function InlineEditor<ItemType>({\n  ariaLabels,\n  item,\n  column,\n  onEditEnd,\n  submitEdit,\n  __onRender,\n}: InlineEditorProps<ItemType>) {\n  const [currentEditLoading, setCurrentEditLoading] = useState(false);\n  const [currentEditValue, setCurrentEditValue] = useState<Optional<any>>();\n  const i18n = useInternalI18n('table');\n\n  const focusLockRef = useRef<FocusLockRef>(null);\n\n  const cellContext = {\n    currentValue: currentEditValue,\n    setValue: setCurrentEditValue,\n  };\n\n  function finishEdit({ cancelled = false, refocusCell = true }: Partial<OnEditEndOptions> = {}) {\n    if (!cancelled) {\n      setCurrentEditValue(undefined);\n    }\n    onEditEnd({ cancelled, refocusCell: refocusCell });\n  }\n\n  async function onSubmitClick(evt: React.FormEvent) {\n    evt.preventDefault();\n    if (currentEditValue === undefined) {\n      finishEdit();\n      return;\n    }\n\n    setCurrentEditLoading(true);\n    try {\n      await submitEdit(item, column, currentEditValue);\n      setCurrentEditLoading(false);\n      finishEdit();\n    } catch (e) {\n      setCurrentEditLoading(false);\n      focusLockRef.current?.focusFirst();\n    }\n  }\n\n  function onCancel({ reFocusEditedCell = true } = {}) {\n    if (currentEditLoading) {\n      return;\n    }\n    finishEdit({ cancelled: true, refocusCell: reFocusEditedCell });\n  }\n\n  function handleEscape(event: React.KeyboardEvent): void {\n    if (event.key === 'Escape') {\n      onCancel();\n    }\n  }\n\n  const clickAwayRef = useClickAway(() => onCancel({ reFocusEditedCell: false }));\n\n  useEffect(() => {\n    if (__onRender) {\n      const timer = setTimeout(__onRender, 1);\n      return () => clearTimeout(timer);\n    }\n  }, [__onRender]);\n\n  // asserting non-undefined editConfig here because this component is unreachable otherwise\n  const {\n    ariaLabel = undefined,\n    validation = noop,\n    errorIconAriaLabel,\n    constraintText,\n    editingCell,\n  } = column.editConfig!;\n\n  return (\n    <FocusLock restoreFocus={true} ref={focusLockRef}>\n      <div\n        role=\"dialog\"\n        ref={clickAwayRef}\n        aria-label={ariaLabels?.activateEditLabel?.(column, item)}\n        onKeyDown={handleEscape}\n      >\n        <form onSubmit={onSubmitClick} className={styles['body-cell-editor-form']}>\n          <FormField\n            stretch={true}\n            label={ariaLabel}\n            constraintText={constraintText}\n            __hideLabel={true}\n            __disableGutters={true}\n            i18nStrings={{ errorIconAriaLabel }}\n            errorText={validation(item, currentEditValue)}\n          >\n            <div className={styles['body-cell-editor-row']}>\n              {editingCell(item, cellContext)}\n              <span className={styles['body-cell-editor-controls']}>\n                <SpaceBetween direction=\"horizontal\" size=\"xxs\">\n                  {!currentEditLoading ? (\n                    <Button\n                      ariaLabel={ariaLabels?.cancelEditLabel?.(column)}\n                      formAction=\"none\"\n                      iconName=\"close\"\n                      variant=\"inline-icon\"\n                      onClick={() => onCancel()}\n                    />\n                  ) : null}\n                  <Button\n                    ariaLabel={ariaLabels?.submitEditLabel?.(column)}\n                    formAction=\"submit\"\n                    iconName=\"check\"\n                    variant=\"inline-icon\"\n                    loading={currentEditLoading}\n                  />\n                </SpaceBetween>\n                <LiveRegion>\n                  {currentEditLoading\n                    ? i18n('ariaLabels.submittingEditText', ariaLabels?.submittingEditText?.(column))\n                    : ''}\n                </LiveRegion>\n              </span>\n            </div>\n          </FormField>\n        </form>\n      </div>\n    </FocusLock>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}