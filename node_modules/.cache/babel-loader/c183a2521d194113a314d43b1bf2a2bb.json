{"ast":null,"code":"import _defineProperty from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { isInteractive, isGroupInteractive, isGroup } from '../../internal/components/option/utils/filter-options';\nimport { useEffect, useRef } from 'react';\nimport { useHighlightedOption } from '../../internal/components/options-list/utils/use-highlight-option';\nimport { useOpenState } from '../../internal/components/options-list/utils/use-open-state';\nimport { useMenuKeyboard, useTriggerKeyboard } from '../../internal/components/options-list/utils/use-keyboard';\nimport { getOptionId } from '../../internal/components/options-list/utils/use-ids';\nimport { connectOptionsByValue } from './connect-options';\nimport useForwardFocus from '../../internal/hooks/forward-focus';\nimport { usePrevious } from '../../internal/hooks/use-previous';\nimport { fireNonCancelableEvent } from '../../internal/events';\nimport { useUniqueId } from '../../internal/hooks/use-unique-id';\nexport function useSelect(_ref) {\n  var selectedOptions = _ref.selectedOptions,\n    updateSelectedOption = _ref.updateSelectedOption,\n    options = _ref.options,\n    filteringType = _ref.filteringType,\n    onBlur = _ref.onBlur,\n    onFocus = _ref.onFocus,\n    externalRef = _ref.externalRef,\n    keepOpen = _ref.keepOpen,\n    fireLoadItems = _ref.fireLoadItems,\n    setFilteringValue = _ref.setFilteringValue,\n    _ref$useInteractiveGr = _ref.useInteractiveGroups,\n    useInteractiveGroups = _ref$useInteractiveGr === void 0 ? false : _ref$useInteractiveGr,\n    statusType = _ref.statusType;\n  var interactivityCheck = useInteractiveGroups ? isGroupInteractive : isInteractive;\n  var isHighlightable = function isHighlightable(option) {\n    return !!option && (useInteractiveGroups || option.type !== 'parent');\n  };\n  var filterRef = useRef(null);\n  var triggerRef = useRef(null);\n  var menuRef = useRef(null);\n  var hasFilter = filteringType !== 'none';\n  var activeRef = hasFilter ? filterRef : menuRef;\n  var __selectedOptions = connectOptionsByValue(options, selectedOptions);\n  var __selectedValuesSet = selectedOptions.reduce(function (selectedValuesSet, item) {\n    if (item.value) {\n      selectedValuesSet.add(item.value);\n    }\n    return selectedValuesSet;\n  }, new Set());\n  var _useHighlightedOption = useHighlightedOption({\n      options: options,\n      isHighlightable: isHighlightable\n    }),\n    _useHighlightedOption2 = _slicedToArray(_useHighlightedOption, 2),\n    _useHighlightedOption3 = _useHighlightedOption2[0],\n    highlightType = _useHighlightedOption3.highlightType,\n    highlightedOption = _useHighlightedOption3.highlightedOption,\n    highlightedIndex = _useHighlightedOption3.highlightedIndex,\n    _useHighlightedOption4 = _useHighlightedOption2[1],\n    moveHighlightWithKeyboard = _useHighlightedOption4.moveHighlightWithKeyboard,\n    resetHighlightWithKeyboard = _useHighlightedOption4.resetHighlightWithKeyboard,\n    setHighlightedIndexWithMouse = _useHighlightedOption4.setHighlightedIndexWithMouse,\n    highlightOptionWithKeyboard = _useHighlightedOption4.highlightOptionWithKeyboard,\n    goHomeWithKeyboard = _useHighlightedOption4.goHomeWithKeyboard,\n    goEndWithKeyboard = _useHighlightedOption4.goEndWithKeyboard;\n  var _useOpenState = useOpenState({\n      onOpen: function onOpen() {\n        return fireLoadItems('');\n      },\n      onClose: function onClose() {\n        resetHighlightWithKeyboard();\n        setFilteringValue('');\n      }\n    }),\n    isOpen = _useOpenState.isOpen,\n    openDropdown = _useOpenState.openDropdown,\n    _closeDropdown = _useOpenState.closeDropdown,\n    toggleDropdown = _useOpenState.toggleDropdown;\n  var handleFocus = function handleFocus() {\n    fireNonCancelableEvent(onFocus, {});\n  };\n  var handleBlur = function handleBlur() {\n    fireNonCancelableEvent(onBlur, {});\n    _closeDropdown();\n  };\n  var hasSelectedOption = __selectedOptions.length > 0;\n  var menuId = useUniqueId('option-list');\n  var dialogId = useUniqueId('dialog');\n  var highlightedOptionId = getOptionId(menuId, highlightedIndex);\n  var selectOption = function selectOption(option) {\n    var _a;\n    var optionToSelect = option || highlightedOption;\n    if (!optionToSelect || !interactivityCheck(optionToSelect)) {\n      return;\n    }\n    updateSelectedOption(optionToSelect.option);\n    if (!keepOpen) {\n      (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      _closeDropdown();\n    }\n  };\n  var activeKeyDownHandler = useMenuKeyboard({\n    moveHighlight: moveHighlightWithKeyboard,\n    selectOption: selectOption,\n    goHome: goHomeWithKeyboard,\n    goEnd: goEndWithKeyboard,\n    closeDropdown: function closeDropdown() {\n      var _a;\n      (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      _closeDropdown();\n    },\n    preventNativeSpace: !hasFilter\n  });\n  var triggerKeyDownHandler = useTriggerKeyboard({\n    openDropdown: openDropdown,\n    goHome: goHomeWithKeyboard\n  });\n  var getDropdownProps = function getDropdownProps() {\n    return {\n      onFocus: handleFocus,\n      onBlur: handleBlur,\n      dropdownContentId: dialogId,\n      dropdownContentRole: hasFilter ? 'dialog' : undefined\n    };\n  };\n  var getTriggerProps = function getTriggerProps() {\n    var disabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var autoFocus = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var triggerProps = {\n      ref: triggerRef,\n      onFocus: function onFocus() {\n        return _closeDropdown();\n      },\n      autoFocus: autoFocus,\n      ariaHasPopup: hasFilter ? 'dialog' : 'listbox',\n      ariaControls: isOpen ? hasFilter ? dialogId : menuId : undefined\n    };\n    if (!disabled) {\n      triggerProps.onMouseDown = function (event) {\n        var _a;\n        event.preventDefault(); // prevent current focus from blurring as it immediately closes the dropdown\n        if (isOpen) {\n          (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n        }\n        toggleDropdown();\n      };\n      triggerProps.onKeyDown = triggerKeyDownHandler;\n    }\n    return triggerProps;\n  };\n  var getFilterProps = function getFilterProps() {\n    var _nativeAttributes;\n    if (!hasFilter) {\n      return {};\n    }\n    return {\n      ref: filterRef,\n      onKeyDown: activeKeyDownHandler,\n      onChange: function onChange(event) {\n        setFilteringValue(event.detail.value);\n        resetHighlightWithKeyboard();\n      },\n      __onDelayedInput: function __onDelayedInput(event) {\n        fireLoadItems(event.detail.value);\n      },\n      __nativeAttributes: (_nativeAttributes = {\n        'aria-activedescendant': highlightedOptionId\n      }, _defineProperty(_nativeAttributes, 'aria-owns', menuId), _defineProperty(_nativeAttributes, 'aria-controls', menuId), _nativeAttributes)\n    };\n  };\n  var getMenuProps = function getMenuProps() {\n    var menuProps = {\n      id: menuId,\n      ref: menuRef,\n      open: isOpen,\n      onMouseUp: function onMouseUp(itemIndex) {\n        if (itemIndex > -1) {\n          selectOption(options[itemIndex]);\n        }\n      },\n      onMouseMove: function onMouseMove(itemIndex) {\n        if (itemIndex > -1) {\n          setHighlightedIndexWithMouse(itemIndex);\n        }\n      },\n      statusType: statusType\n    };\n    if (!hasFilter) {\n      menuProps.onKeyDown = activeKeyDownHandler;\n      menuProps.nativeAttributes = {\n        'aria-activedescendant': highlightedOptionId\n      };\n    }\n    return menuProps;\n  };\n  var getGroupState = function getGroupState(option) {\n    var totalSelected = option.options.filter(function (item) {\n      return !!item.value && __selectedValuesSet.has(item.value);\n    }).length;\n    var hasSelected = totalSelected > 0;\n    var allSelected = totalSelected === option.options.length;\n    return {\n      selected: hasSelected && allSelected,\n      indeterminate: hasSelected && !allSelected\n    };\n  };\n  var getOptionProps = function getOptionProps(option, index) {\n    var _optionProps;\n    var _a;\n    var highlighted = option === highlightedOption;\n    var groupState = isGroup(option.option) ? getGroupState(option.option) : undefined;\n    var selected = __selectedOptions.indexOf(option) > -1 || !!(groupState === null || groupState === void 0 ? void 0 : groupState.selected);\n    var nextOption = (_a = options[index + 1]) === null || _a === void 0 ? void 0 : _a.option;\n    var isNextSelected = !!nextOption && isGroup(nextOption) ? getGroupState(nextOption).selected : __selectedOptions.indexOf(options[index + 1]) > -1;\n    var optionProps = (_optionProps = {\n      key: index,\n      option: option,\n      highlighted: highlighted,\n      selected: selected,\n      isNextSelected: isNextSelected,\n      indeterminate: !!(groupState === null || groupState === void 0 ? void 0 : groupState.indeterminate)\n    }, _defineProperty(_optionProps, 'data-mouse-target', isHighlightable(option) ? index : -1), _defineProperty(_optionProps, \"id\", getOptionId(menuId, index)), _optionProps);\n    return optionProps;\n  };\n  var prevOpen = usePrevious(isOpen);\n  useEffect(function () {\n    // highlight the first selected option, when opening the Select component without filter input\n    // keep the focus in the filter input when opening, so that screenreader can recognize the combobox\n    if (isOpen && !prevOpen && hasSelectedOption && !hasFilter) {\n      setHighlightedIndexWithMouse(options.indexOf(__selectedOptions[0]));\n    }\n  }, [isOpen, __selectedOptions, hasSelectedOption, setHighlightedIndexWithMouse, options, prevOpen, hasFilter]);\n  useEffect(function () {\n    var _a;\n    if (isOpen) {\n      // dropdown-fit calculations ensure that the dropdown will fit inside the current\n      // viewport, so prevent the browser from trying to scroll it into view (e.g. if\n      // scroll-padding-top is set on a parent)\n      (_a = activeRef.current) === null || _a === void 0 ? void 0 : _a.focus({\n        preventScroll: true\n      });\n    }\n  }, [isOpen, activeRef]);\n  useForwardFocus(externalRef, triggerRef);\n  var highlightedGroupSelected = !!highlightedOption && isGroup(highlightedOption.option) && getGroupState(highlightedOption.option).selected;\n  var announceSelected = !!highlightedOption && (__selectedOptions.indexOf(highlightedOption) > -1 || highlightedGroupSelected);\n  return {\n    isOpen: isOpen,\n    highlightedOption: highlightedOption,\n    highlightedIndex: highlightedIndex,\n    highlightType: highlightType,\n    getTriggerProps: getTriggerProps,\n    getDropdownProps: getDropdownProps,\n    getMenuProps: getMenuProps,\n    getFilterProps: getFilterProps,\n    getOptionProps: getOptionProps,\n    highlightOption: highlightOptionWithKeyboard,\n    selectOption: selectOption,\n    announceSelected: announceSelected,\n    dialogId: dialogId\n  };\n}","map":{"version":3,"mappings":"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","names":["isInteractive","isGroupInteractive","isGroup","useEffect","useRef","useHighlightedOption","useOpenState","useMenuKeyboard","useTriggerKeyboard","getOptionId","connectOptionsByValue","useForwardFocus","usePrevious","fireNonCancelableEvent","useUniqueId","useSelect","selectedOptions","updateSelectedOption","options","filteringType","onBlur","onFocus","externalRef","keepOpen","fireLoadItems","setFilteringValue","useInteractiveGroups","statusType","interactivityCheck","isHighlightable","option","type","filterRef","triggerRef","menuRef","hasFilter","activeRef","__selectedOptions","__selectedValuesSet","reduce","selectedValuesSet","item","value","add","Set","highlightType","highlightedOption","highlightedIndex","moveHighlightWithKeyboard","resetHighlightWithKeyboard","setHighlightedIndexWithMouse","highlightOptionWithKeyboard","goHomeWithKeyboard","goEndWithKeyboard","onOpen","onClose","isOpen","openDropdown","closeDropdown","toggleDropdown","handleFocus","handleBlur","hasSelectedOption","length","menuId","dialogId","highlightedOptionId","selectOption","optionToSelect","current","focus","activeKeyDownHandler","moveHighlight","goHome","goEnd","preventNativeSpace","triggerKeyDownHandler","getDropdownProps","dropdownContentId","dropdownContentRole","undefined","getTriggerProps","disabled","autoFocus","triggerProps","ref","ariaHasPopup","ariaControls","onMouseDown","event","preventDefault","onKeyDown","getFilterProps","onChange","detail","__onDelayedInput","__nativeAttributes","getMenuProps","menuProps","id","open","onMouseUp","itemIndex","onMouseMove","nativeAttributes","getGroupState","totalSelected","filter","has","hasSelected","allSelected","selected","indeterminate","getOptionProps","index","highlighted","groupState","indexOf","nextOption","isNextSelected","optionProps","key","prevOpen","preventScroll","highlightedGroupSelected","announceSelected","highlightOption"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/select/utils/lib/default/select/utils/use-select.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { RefObject } from 'react';\nimport { DropdownProps } from '../../internal/components/dropdown/interfaces';\nimport { DropdownOption, OptionDefinition, OptionGroup } from '../../internal/components/option/interfaces';\nimport { isInteractive, isGroupInteractive, isGroup } from '../../internal/components/option/utils/filter-options';\nimport { useEffect, useRef } from 'react';\nimport { useHighlightedOption } from '../../internal/components/options-list/utils/use-highlight-option';\nimport { useOpenState } from '../../internal/components/options-list/utils/use-open-state';\nimport { useMenuKeyboard, useTriggerKeyboard } from '../../internal/components/options-list/utils/use-keyboard';\nimport { getOptionId } from '../../internal/components/options-list/utils/use-ids';\nimport { connectOptionsByValue } from './connect-options';\nimport useForwardFocus from '../../internal/hooks/forward-focus';\nimport { OptionsListProps } from '../../internal/components/options-list';\nimport { FilterProps } from '../parts/filter';\nimport { ItemProps } from '../parts/item';\nimport { usePrevious } from '../../internal/hooks/use-previous';\nimport { NonCancelableEventHandler, fireNonCancelableEvent } from '../../internal/events';\nimport { useUniqueId } from '../../internal/hooks/use-unique-id';\nimport { DropdownStatusProps } from '../../internal/components/dropdown-status';\nimport { ButtonTriggerProps } from '../../internal/components/button-trigger';\n\nexport type MenuProps = Omit<OptionsListProps, 'children'> & { ref: React.RefObject<HTMLUListElement> };\nexport type GetOptionProps = (option: DropdownOption, index: number) => ItemProps;\n\ninterface UseSelectProps {\n  selectedOptions: ReadonlyArray<OptionDefinition>;\n  updateSelectedOption: (option: OptionDefinition) => void;\n  options: ReadonlyArray<DropdownOption>;\n  filteringType: string;\n  keepOpen?: boolean;\n  onBlur?: NonCancelableEventHandler;\n  onFocus?: NonCancelableEventHandler;\n  externalRef: React.Ref<any>;\n  fireLoadItems: (filteringText: string) => void;\n  setFilteringValue: (filteringText: string) => void;\n  useInteractiveGroups?: boolean;\n  statusType: DropdownStatusProps.StatusType;\n}\n\nexport interface SelectTriggerProps extends ButtonTriggerProps {\n  ref: RefObject<HTMLButtonElement>;\n}\n\nexport function useSelect({\n  selectedOptions,\n  updateSelectedOption,\n  options,\n  filteringType,\n  onBlur,\n  onFocus,\n  externalRef,\n  keepOpen,\n  fireLoadItems,\n  setFilteringValue,\n  useInteractiveGroups = false,\n  statusType,\n}: UseSelectProps) {\n  const interactivityCheck = useInteractiveGroups ? isGroupInteractive : isInteractive;\n\n  const isHighlightable = (option?: DropdownOption) => !!option && (useInteractiveGroups || option.type !== 'parent');\n\n  const filterRef = useRef<HTMLInputElement>(null);\n  const triggerRef = useRef<HTMLButtonElement>(null);\n  const menuRef = useRef<HTMLUListElement>(null);\n  const hasFilter = filteringType !== 'none';\n  const activeRef = hasFilter ? filterRef : menuRef;\n  const __selectedOptions = connectOptionsByValue(options, selectedOptions);\n  const __selectedValuesSet = selectedOptions.reduce((selectedValuesSet: Set<string>, item: OptionDefinition) => {\n    if (item.value) {\n      selectedValuesSet.add(item.value);\n    }\n    return selectedValuesSet;\n  }, new Set<string>());\n  const [\n    { highlightType, highlightedOption, highlightedIndex },\n    {\n      moveHighlightWithKeyboard,\n      resetHighlightWithKeyboard,\n      setHighlightedIndexWithMouse,\n      highlightOptionWithKeyboard,\n      goHomeWithKeyboard,\n      goEndWithKeyboard,\n    },\n  ] = useHighlightedOption({ options, isHighlightable });\n\n  const { isOpen, openDropdown, closeDropdown, toggleDropdown } = useOpenState({\n    onOpen: () => fireLoadItems(''),\n    onClose: () => {\n      resetHighlightWithKeyboard();\n      setFilteringValue('');\n    },\n  });\n\n  const handleFocus = () => {\n    fireNonCancelableEvent(onFocus, {});\n  };\n\n  const handleBlur = () => {\n    fireNonCancelableEvent(onBlur, {});\n    closeDropdown();\n  };\n\n  const hasSelectedOption = __selectedOptions.length > 0;\n  const menuId = useUniqueId('option-list');\n  const dialogId = useUniqueId('dialog');\n  const highlightedOptionId = getOptionId(menuId, highlightedIndex);\n\n  const selectOption = (option?: DropdownOption) => {\n    const optionToSelect = option || highlightedOption;\n    if (!optionToSelect || !interactivityCheck(optionToSelect)) {\n      return;\n    }\n    updateSelectedOption(optionToSelect.option);\n    if (!keepOpen) {\n      triggerRef.current?.focus();\n      closeDropdown();\n    }\n  };\n\n  const activeKeyDownHandler = useMenuKeyboard({\n    moveHighlight: moveHighlightWithKeyboard,\n    selectOption,\n    goHome: goHomeWithKeyboard,\n    goEnd: goEndWithKeyboard,\n    closeDropdown: () => {\n      triggerRef.current?.focus();\n      closeDropdown();\n    },\n    preventNativeSpace: !hasFilter,\n  });\n\n  const triggerKeyDownHandler = useTriggerKeyboard({ openDropdown, goHome: goHomeWithKeyboard });\n\n  const getDropdownProps: () => Pick<\n    DropdownProps,\n    'onFocus' | 'onBlur' | 'dropdownContentId' | 'dropdownContentRole'\n  > = () => ({\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    dropdownContentId: dialogId,\n    dropdownContentRole: hasFilter ? 'dialog' : undefined,\n  });\n\n  const getTriggerProps = (disabled = false, autoFocus = false) => {\n    const triggerProps: SelectTriggerProps = {\n      ref: triggerRef,\n      onFocus: () => closeDropdown(),\n      autoFocus,\n      ariaHasPopup: hasFilter ? 'dialog' : 'listbox',\n      ariaControls: isOpen ? (hasFilter ? dialogId : menuId) : undefined,\n    };\n    if (!disabled) {\n      triggerProps.onMouseDown = (event: CustomEvent) => {\n        event.preventDefault(); // prevent current focus from blurring as it immediately closes the dropdown\n        if (isOpen) {\n          triggerRef.current?.focus();\n        }\n        toggleDropdown();\n      };\n      triggerProps.onKeyDown = triggerKeyDownHandler;\n    }\n    return triggerProps;\n  };\n\n  const getFilterProps = (): Partial<FilterProps> => {\n    if (!hasFilter) {\n      return {};\n    }\n\n    return {\n      ref: filterRef,\n      onKeyDown: activeKeyDownHandler,\n      onChange: event => {\n        setFilteringValue(event.detail.value);\n        resetHighlightWithKeyboard();\n      },\n      __onDelayedInput: event => {\n        fireLoadItems(event.detail.value);\n      },\n      __nativeAttributes: {\n        'aria-activedescendant': highlightedOptionId,\n        ['aria-owns']: menuId,\n        ['aria-controls']: menuId,\n      },\n    };\n  };\n\n  const getMenuProps = () => {\n    const menuProps: MenuProps = {\n      id: menuId,\n      ref: menuRef,\n      open: isOpen,\n      onMouseUp: itemIndex => {\n        if (itemIndex > -1) {\n          selectOption(options[itemIndex]);\n        }\n      },\n      onMouseMove: itemIndex => {\n        if (itemIndex > -1) {\n          setHighlightedIndexWithMouse(itemIndex);\n        }\n      },\n      statusType,\n    };\n    if (!hasFilter) {\n      menuProps.onKeyDown = activeKeyDownHandler;\n      menuProps.nativeAttributes = {\n        'aria-activedescendant': highlightedOptionId,\n      };\n    }\n    return menuProps;\n  };\n  const getGroupState = (option: OptionGroup) => {\n    const totalSelected = option.options.filter(item => !!item.value && __selectedValuesSet.has(item.value)).length;\n    const hasSelected = totalSelected > 0;\n    const allSelected = totalSelected === option.options.length;\n    return {\n      selected: hasSelected && allSelected,\n      indeterminate: hasSelected && !allSelected,\n    };\n  };\n\n  const getOptionProps = (option: DropdownOption, index: number) => {\n    const highlighted = option === highlightedOption;\n    const groupState = isGroup(option.option) ? getGroupState(option.option) : undefined;\n    const selected = __selectedOptions.indexOf(option) > -1 || !!groupState?.selected;\n    const nextOption = options[index + 1]?.option;\n    const isNextSelected =\n      !!nextOption && isGroup(nextOption)\n        ? getGroupState(nextOption).selected\n        : __selectedOptions.indexOf(options[index + 1]) > -1;\n\n    const optionProps: any = {\n      key: index,\n      option,\n      highlighted,\n      selected,\n      isNextSelected,\n      indeterminate: !!groupState?.indeterminate,\n      ['data-mouse-target']: isHighlightable(option) ? index : -1,\n      id: getOptionId(menuId, index),\n    };\n\n    return optionProps;\n  };\n\n  const prevOpen = usePrevious<boolean>(isOpen);\n  useEffect(() => {\n    // highlight the first selected option, when opening the Select component without filter input\n    // keep the focus in the filter input when opening, so that screenreader can recognize the combobox\n    if (isOpen && !prevOpen && hasSelectedOption && !hasFilter) {\n      setHighlightedIndexWithMouse(options.indexOf(__selectedOptions[0]));\n    }\n  }, [isOpen, __selectedOptions, hasSelectedOption, setHighlightedIndexWithMouse, options, prevOpen, hasFilter]);\n\n  useEffect(() => {\n    if (isOpen) {\n      // dropdown-fit calculations ensure that the dropdown will fit inside the current\n      // viewport, so prevent the browser from trying to scroll it into view (e.g. if\n      // scroll-padding-top is set on a parent)\n      activeRef.current?.focus({ preventScroll: true });\n    }\n  }, [isOpen, activeRef]);\n\n  useForwardFocus(externalRef, triggerRef as React.RefObject<HTMLElement>);\n  const highlightedGroupSelected =\n    !!highlightedOption && isGroup(highlightedOption.option) && getGroupState(highlightedOption.option).selected;\n  const announceSelected =\n    !!highlightedOption && (__selectedOptions.indexOf(highlightedOption) > -1 || highlightedGroupSelected);\n\n  return {\n    isOpen,\n    highlightedOption,\n    highlightedIndex,\n    highlightType,\n    getTriggerProps,\n    getDropdownProps,\n    getMenuProps,\n    getFilterProps,\n    getOptionProps,\n    highlightOption: highlightOptionWithKeyboard,\n    selectOption,\n    announceSelected,\n    dialogId,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}