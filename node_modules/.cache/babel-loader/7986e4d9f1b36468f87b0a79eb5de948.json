{"ast":null,"code":"import _slicedToArray from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _defineProperty from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport clsx from 'clsx';\nimport React, { useRef } from 'react';\nimport { ToggleButton, CloseButton, togglesConfig } from '../toggles';\nimport testutilStyles from '../test-classes/styles.css.js';\nimport styles from './styles.css.js';\nimport OverflowMenu from './overflow-menu';\nimport { useContainerQuery } from '@cloudscape-design/component-toolkit';\nimport { useDensityMode } from '@cloudscape-design/component-toolkit/internal';\nimport { splitItems } from './drawers-helpers';\nimport { TOOLS_DRAWER_ID } from '../utils/use-drawers';\n// We are using two landmarks per drawer, i.e. two NAVs and two ASIDEs, because of several\n// known bugs in NVDA that cause focus changes within a container to sometimes not be\n// announced. As a result, we use one region for the open button and one region for the\n// actual drawer content, always hiding the other one when it's not visible.\n// An alternative solution to follow a more classic implementation here to only have one\n// button that triggers the opening/closing of the drawer also did not work due to another\n// series of bugs in NVDA (together with Firefox) which prevent the changed expanded state\n// from being announced.\n// Even with this workaround in place, the announcement of the close button when opening a\n// panel in NVDA is not working correctly. The suspected root cause is one of the bugs below\n// as well.\n// Relevant tickets:\n// * https://github.com/nvaccess/nvda/issues/6606\n// * https://github.com/nvaccess/nvda/issues/5825\n// * https://github.com/nvaccess/nvda/issues/5247\n// * https://github.com/nvaccess/nvda/pull/8869 (reverted PR that was going to fix it)\nexport var Drawer = React.forwardRef(function (_ref, ref) {\n  var _clsx;\n  var contentClassName = _ref.contentClassName,\n    toggleClassName = _ref.toggleClassName,\n    closeClassName = _ref.closeClassName,\n    width = _ref.width,\n    type = _ref.type,\n    toggleRefs = _ref.toggleRefs,\n    topOffset = _ref.topOffset,\n    bottomOffset = _ref.bottomOffset,\n    ariaLabels = _ref.ariaLabels,\n    drawersAriaLabels = _ref.drawersAriaLabels,\n    children = _ref.children,\n    isOpen = _ref.isOpen,\n    isHidden = _ref.isHidden,\n    isMobile = _ref.isMobile,\n    onToggle = _ref.onToggle,\n    _onClick = _ref.onClick,\n    onLoseFocus = _ref.onLoseFocus,\n    drawers = _ref.drawers,\n    resizeHandle = _ref.resizeHandle;\n  var openButtonWrapperRef = useRef(null);\n  var _togglesConfig$type = togglesConfig[type],\n    TagName = _togglesConfig$type.TagName,\n    iconName = _togglesConfig$type.iconName,\n    getLabels = _togglesConfig$type.getLabels;\n  var _ref2 = drawersAriaLabels !== null && drawersAriaLabels !== void 0 ? drawersAriaLabels : getLabels(ariaLabels),\n    mainLabel = _ref2.mainLabel,\n    closeLabel = _ref2.closeLabel,\n    openLabel = _ref2.openLabel;\n  var drawerContentWidthOpen = isMobile ? undefined : width;\n  var drawerContentWidth = isOpen ? drawerContentWidthOpen : undefined;\n  var regularOpenButton = React.createElement(TagName, {\n    ref: openButtonWrapperRef,\n    \"aria-label\": mainLabel,\n    className: styles.toggle,\n    \"aria-hidden\": isOpen\n  }, React.createElement(ToggleButton, {\n    ref: toggleRefs.toggle,\n    className: toggleClassName,\n    iconName: iconName,\n    ariaLabel: openLabel,\n    onClick: function onClick() {\n      return onToggle(true);\n    },\n    ariaExpanded: isOpen ? undefined : false\n  }));\n  return React.createElement(\"div\", {\n    id: drawers === null || drawers === void 0 ? void 0 : drawers.activeDrawerId,\n    ref: ref,\n    className: clsx(styles.drawer, (_clsx = {}, _defineProperty(_clsx, styles.hide, isHidden), _defineProperty(_clsx, styles['drawer-closed'], !isOpen), _defineProperty(_clsx, testutilStyles['drawer-closed'], !isOpen), _defineProperty(_clsx, styles['drawer-mobile'], isMobile), _clsx)),\n    style: {\n      width: drawerContentWidth\n    },\n    onBlur: onLoseFocus ? function (e) {\n      if (!e.relatedTarget || !e.currentTarget.contains(e.relatedTarget)) {\n        onLoseFocus(e);\n      }\n    } : undefined,\n    onClick: function onClick(event) {\n      var _a;\n      if (_onClick) {\n        _onClick(event);\n      }\n      if (!isOpen) {\n        // to prevent calling onToggle from the drawer when it's called from the toggle button\n        if (openButtonWrapperRef.current === event.target || !((_a = openButtonWrapperRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target))) {\n          onToggle(true);\n        }\n      }\n    }\n  }, React.createElement(\"div\", {\n    style: {\n      width: drawerContentWidth,\n      top: topOffset,\n      bottom: bottomOffset\n    },\n    className: clsx(styles['drawer-content'], styles['drawer-content-clickable'], contentClassName)\n  }, !isMobile && !drawers && regularOpenButton, resizeHandle, React.createElement(TagName, {\n    \"aria-label\": mainLabel,\n    \"aria-hidden\": !isOpen\n  }, React.createElement(CloseButton, {\n    ref: toggleRefs.close,\n    className: closeClassName,\n    ariaLabel: closeLabel,\n    onClick: function onClick() {\n      onToggle(false);\n      drawers === null || drawers === void 0 ? void 0 : drawers.onChange({\n        activeDrawerId: undefined\n      });\n    }\n  }), children)));\n});\nvar DrawerTrigger = React.forwardRef(function (_ref3, ref) {\n  var testUtilsClassName = _ref3.testUtilsClassName,\n    ariaLabel = _ref3.ariaLabel,\n    ariaExpanded = _ref3.ariaExpanded,\n    ariaControls = _ref3.ariaControls,\n    badge = _ref3.badge,\n    itemId = _ref3.itemId,\n    isActive = _ref3.isActive,\n    trigger = _ref3.trigger,\n    onClick = _ref3.onClick;\n  return React.createElement(\"div\", {\n    className: clsx(styles['drawer-trigger'], isActive && styles['drawer-trigger-active']),\n    onClick: onClick\n  }, React.createElement(ToggleButton, {\n    ref: ref,\n    className: testUtilsClassName,\n    iconName: trigger.iconName,\n    iconSvg: trigger.iconSvg,\n    ariaLabel: ariaLabel,\n    ariaExpanded: ariaExpanded,\n    ariaControls: ariaControls,\n    badge: badge,\n    testId: itemId && \"awsui-app-layout-trigger-\".concat(itemId)\n  }));\n});\nexport var DrawerTriggersBar = function DrawerTriggersBar(_ref4) {\n  var _clsx2;\n  var isMobile = _ref4.isMobile,\n    topOffset = _ref4.topOffset,\n    bottomOffset = _ref4.bottomOffset,\n    drawers = _ref4.drawers;\n  var containerRef = React.useRef(null);\n  var _useContainerQuery = useContainerQuery(function (rect) {\n      return rect.contentBoxHeight;\n    }),\n    _useContainerQuery2 = _slicedToArray(_useContainerQuery, 2),\n    containerHeight = _useContainerQuery2[0],\n    triggersContainerRef = _useContainerQuery2[1];\n  var isCompactMode = useDensityMode(containerRef) === 'compact';\n  var getIndexOfOverflowItem = function getIndexOfOverflowItem() {\n    if (containerHeight) {\n      var ITEM_HEIGHT = isCompactMode ? 34 : 38;\n      var overflowSpot = containerHeight / 1.5;\n      var index = Math.floor(overflowSpot / ITEM_HEIGHT);\n      return index;\n    }\n    return 0;\n  };\n  var _splitItems = splitItems(drawers === null || drawers === void 0 ? void 0 : drawers.items, getIndexOfOverflowItem(), drawers === null || drawers === void 0 ? void 0 : drawers.activeDrawerId),\n    visibleItems = _splitItems.visibleItems,\n    overflowItems = _splitItems.overflowItems;\n  var overflowMenuHasBadge = !!overflowItems.find(function (item) {\n    return item.badge;\n  });\n  return React.createElement(\"div\", {\n    className: clsx(styles.drawer, styles['drawer-closed'], testutilStyles['drawer-closed'], (_clsx2 = {}, _defineProperty(_clsx2, styles['drawer-mobile'], isMobile), _defineProperty(_clsx2, styles.hide, (drawers === null || drawers === void 0 ? void 0 : drawers.items.length) === 1 && drawers.activeDrawerId !== undefined), _clsx2)),\n    ref: containerRef\n  }, React.createElement(\"div\", {\n    ref: triggersContainerRef,\n    style: {\n      top: topOffset,\n      bottom: bottomOffset\n    },\n    className: clsx(styles['drawer-content'], _defineProperty({}, styles['drawer-content-clickable'], (drawers === null || drawers === void 0 ? void 0 : drawers.items.length) === 1)),\n    onClick: function onClick() {\n      (drawers === null || drawers === void 0 ? void 0 : drawers.items.length) === 1 && (drawers === null || drawers === void 0 ? void 0 : drawers.onChange({\n        activeDrawerId: drawers.items[0].id !== drawers.activeDrawerId ? drawers.items[0].id : undefined\n      }));\n    }\n  }, !isMobile && React.createElement(\"aside\", {\n    \"aria-label\": drawers === null || drawers === void 0 ? void 0 : drawers.ariaLabel,\n    role: \"region\"\n  }, React.createElement(\"div\", {\n    className: clsx(styles['drawer-triggers-wrapper']),\n    role: \"toolbar\",\n    \"aria-orientation\": \"vertical\"\n  }, visibleItems.map(function (item, index) {\n    var _a;\n    return React.createElement(DrawerTrigger, {\n      key: index,\n      testUtilsClassName: clsx(testutilStyles['drawers-trigger'], item.id === TOOLS_DRAWER_ID && testutilStyles['tools-toggle']),\n      ariaExpanded: (drawers === null || drawers === void 0 ? void 0 : drawers.activeDrawerId) === item.id,\n      ariaLabel: (_a = item.ariaLabels) === null || _a === void 0 ? void 0 : _a.triggerButton,\n      ariaControls: (drawers === null || drawers === void 0 ? void 0 : drawers.activeDrawerId) === item.id ? item.id : undefined,\n      trigger: item.trigger,\n      badge: item.badge,\n      itemId: item.id,\n      isActive: (drawers === null || drawers === void 0 ? void 0 : drawers.activeDrawerId) === item.id,\n      onClick: function onClick() {\n        (drawers === null || drawers === void 0 ? void 0 : drawers.items.length) !== 1 && (drawers === null || drawers === void 0 ? void 0 : drawers.onChange({\n          activeDrawerId: item.id !== drawers.activeDrawerId ? item.id : undefined\n        }));\n      }\n    });\n  }), overflowItems.length > 0 && React.createElement(\"div\", {\n    className: clsx(styles['drawer-trigger'])\n  }, React.createElement(OverflowMenu, {\n    ariaLabel: overflowMenuHasBadge ? drawers === null || drawers === void 0 ? void 0 : drawers.overflowWithBadgeAriaLabel : drawers === null || drawers === void 0 ? void 0 : drawers.overflowAriaLabel,\n    items: overflowItems,\n    onItemClick: function onItemClick(_ref5) {\n      var detail = _ref5.detail;\n      drawers === null || drawers === void 0 ? void 0 : drawers.onChange({\n        activeDrawerId: detail.id !== drawers.activeDrawerId ? detail.id : undefined\n      });\n    }\n  }))))));\n};","map":{"version":3,"mappings":"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","names":["clsx","React","useRef","ToggleButton","CloseButton","togglesConfig","testutilStyles","styles","OverflowMenu","useContainerQuery","useDensityMode","splitItems","TOOLS_DRAWER_ID","Drawer","forwardRef","ref","contentClassName","toggleClassName","closeClassName","width","type","toggleRefs","topOffset","bottomOffset","ariaLabels","drawersAriaLabels","children","isOpen","isHidden","isMobile","onToggle","onClick","onLoseFocus","drawers","resizeHandle","openButtonWrapperRef","TagName","iconName","getLabels","mainLabel","closeLabel","openLabel","drawerContentWidthOpen","undefined","drawerContentWidth","regularOpenButton","className","toggle","ariaLabel","ariaExpanded","id","activeDrawerId","drawer","hide","style","onBlur","e","relatedTarget","currentTarget","contains","event","current","target","top","bottom","close","onChange","DrawerTrigger","testUtilsClassName","ariaControls","badge","itemId","isActive","trigger","iconSvg","testId","DrawerTriggersBar","containerRef","rect","contentBoxHeight","containerHeight","triggersContainerRef","isCompactMode","getIndexOfOverflowItem","ITEM_HEIGHT","overflowSpot","index","Math","floor","items","visibleItems","overflowItems","overflowMenuHasBadge","find","item","length","role","map","key","triggerButton","overflowWithBadgeAriaLabel","overflowAriaLabel","onItemClick","detail"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/app-layout/drawer/lib/default/app-layout/drawer/index.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport clsx from 'clsx';\nimport React, { useRef } from 'react';\nimport { ToggleButton, CloseButton, togglesConfig } from '../toggles';\n\nimport testutilStyles from '../test-classes/styles.css.js';\nimport styles from './styles.css.js';\nimport { DesktopDrawerProps, DrawerTriggersBarProps, DrawerItem } from './interfaces';\nimport OverflowMenu from './overflow-menu';\nimport { useContainerQuery } from '@cloudscape-design/component-toolkit';\nimport { useDensityMode } from '@cloudscape-design/component-toolkit/internal';\nimport { splitItems } from './drawers-helpers';\nimport { TOOLS_DRAWER_ID } from '../utils/use-drawers';\n\n// We are using two landmarks per drawer, i.e. two NAVs and two ASIDEs, because of several\n// known bugs in NVDA that cause focus changes within a container to sometimes not be\n// announced. As a result, we use one region for the open button and one region for the\n// actual drawer content, always hiding the other one when it's not visible.\n// An alternative solution to follow a more classic implementation here to only have one\n// button that triggers the opening/closing of the drawer also did not work due to another\n// series of bugs in NVDA (together with Firefox) which prevent the changed expanded state\n// from being announced.\n// Even with this workaround in place, the announcement of the close button when opening a\n// panel in NVDA is not working correctly. The suspected root cause is one of the bugs below\n// as well.\n// Relevant tickets:\n// * https://github.com/nvaccess/nvda/issues/6606\n// * https://github.com/nvaccess/nvda/issues/5825\n// * https://github.com/nvaccess/nvda/issues/5247\n// * https://github.com/nvaccess/nvda/pull/8869 (reverted PR that was going to fix it)\nexport const Drawer = React.forwardRef(\n  (\n    {\n      contentClassName,\n      toggleClassName,\n      closeClassName,\n      width,\n      type,\n      toggleRefs,\n      topOffset,\n      bottomOffset,\n      ariaLabels,\n      drawersAriaLabels,\n      children,\n      isOpen,\n      isHidden,\n      isMobile,\n      onToggle,\n      onClick,\n      onLoseFocus,\n      drawers,\n      resizeHandle,\n    }: DesktopDrawerProps,\n    ref: React.Ref<HTMLDivElement>\n  ) => {\n    const openButtonWrapperRef = useRef<HTMLElement | null>(null);\n    const { TagName, iconName, getLabels } = togglesConfig[type];\n    const { mainLabel, closeLabel, openLabel } = drawersAriaLabels ?? getLabels(ariaLabels);\n    const drawerContentWidthOpen = isMobile ? undefined : width;\n    const drawerContentWidth = isOpen ? drawerContentWidthOpen : undefined;\n\n    const regularOpenButton = (\n      <TagName ref={openButtonWrapperRef} aria-label={mainLabel} className={styles.toggle} aria-hidden={isOpen}>\n        <ToggleButton\n          ref={toggleRefs.toggle}\n          className={toggleClassName}\n          iconName={iconName}\n          ariaLabel={openLabel}\n          onClick={() => onToggle(true)}\n          ariaExpanded={isOpen ? undefined : false}\n        />\n      </TagName>\n    );\n\n    return (\n      <div\n        id={drawers?.activeDrawerId}\n        ref={ref}\n        className={clsx(styles.drawer, {\n          [styles.hide]: isHidden,\n          [styles['drawer-closed']]: !isOpen,\n          [testutilStyles['drawer-closed']]: !isOpen,\n          [styles['drawer-mobile']]: isMobile,\n        })}\n        style={{ width: drawerContentWidth }}\n        onBlur={\n          onLoseFocus\n            ? e => {\n                if (!e.relatedTarget || !e.currentTarget.contains(e.relatedTarget)) {\n                  onLoseFocus(e);\n                }\n              }\n            : undefined\n        }\n        onClick={event => {\n          if (onClick) {\n            onClick(event);\n          }\n          if (!isOpen) {\n            // to prevent calling onToggle from the drawer when it's called from the toggle button\n            if (\n              openButtonWrapperRef.current === event.target ||\n              !openButtonWrapperRef.current?.contains(event.target as Node)\n            ) {\n              onToggle(true);\n            }\n          }\n        }}\n      >\n        <div\n          style={{ width: drawerContentWidth, top: topOffset, bottom: bottomOffset }}\n          className={clsx(styles['drawer-content'], styles['drawer-content-clickable'], contentClassName)}\n        >\n          {!isMobile && !drawers && regularOpenButton}\n          {resizeHandle}\n          <TagName aria-label={mainLabel} aria-hidden={!isOpen}>\n            <CloseButton\n              ref={toggleRefs.close}\n              className={closeClassName}\n              ariaLabel={closeLabel}\n              onClick={() => {\n                onToggle(false);\n                drawers?.onChange({ activeDrawerId: undefined });\n              }}\n            />\n            {children}\n          </TagName>\n        </div>\n      </div>\n    );\n  }\n);\n\ninterface DrawerTriggerProps {\n  testUtilsClassName?: string;\n  ariaLabel: string | undefined;\n  ariaExpanded: boolean;\n  ariaControls?: string;\n  badge: boolean | undefined;\n  itemId?: string;\n  isActive: boolean;\n  trigger: DrawerItem['trigger'];\n  onClick: () => void;\n}\n\nconst DrawerTrigger = React.forwardRef(\n  (\n    {\n      testUtilsClassName,\n      ariaLabel,\n      ariaExpanded,\n      ariaControls,\n      badge,\n      itemId,\n      isActive,\n      trigger,\n      onClick,\n    }: DrawerTriggerProps,\n    ref: React.Ref<{ focus: () => void }>\n  ) => (\n    <div className={clsx(styles['drawer-trigger'], isActive && styles['drawer-trigger-active'])} onClick={onClick}>\n      <ToggleButton\n        ref={ref}\n        className={testUtilsClassName}\n        iconName={trigger.iconName}\n        iconSvg={trigger.iconSvg}\n        ariaLabel={ariaLabel}\n        ariaExpanded={ariaExpanded}\n        ariaControls={ariaControls}\n        badge={badge}\n        testId={itemId && `awsui-app-layout-trigger-${itemId}`}\n      />\n    </div>\n  )\n);\n\nexport const DrawerTriggersBar = ({ isMobile, topOffset, bottomOffset, drawers }: DrawerTriggersBarProps) => {\n  const containerRef = React.useRef<HTMLDivElement>(null);\n  const [containerHeight, triggersContainerRef] = useContainerQuery(rect => rect.contentBoxHeight);\n  const isCompactMode = useDensityMode(containerRef) === 'compact';\n\n  const getIndexOfOverflowItem = () => {\n    if (containerHeight) {\n      const ITEM_HEIGHT = isCompactMode ? 34 : 38;\n      const overflowSpot = containerHeight / 1.5;\n\n      const index = Math.floor(overflowSpot / ITEM_HEIGHT);\n\n      return index;\n    }\n    return 0;\n  };\n\n  const { visibleItems, overflowItems } = splitItems(drawers?.items, getIndexOfOverflowItem(), drawers?.activeDrawerId);\n  const overflowMenuHasBadge = !!overflowItems.find(item => item.badge);\n\n  return (\n    <div\n      className={clsx(styles.drawer, styles['drawer-closed'], testutilStyles['drawer-closed'], {\n        [styles['drawer-mobile']]: isMobile,\n        [styles.hide]: drawers?.items.length === 1 && drawers.activeDrawerId !== undefined,\n      })}\n      ref={containerRef}\n    >\n      <div\n        ref={triggersContainerRef}\n        style={{ top: topOffset, bottom: bottomOffset }}\n        className={clsx(styles['drawer-content'], {\n          [styles['drawer-content-clickable']]: drawers?.items.length === 1,\n        })}\n        onClick={() => {\n          drawers?.items.length === 1 &&\n            drawers?.onChange({\n              activeDrawerId: drawers.items[0].id !== drawers.activeDrawerId ? drawers.items[0].id : undefined,\n            });\n        }}\n      >\n        {!isMobile && (\n          <aside aria-label={drawers?.ariaLabel} role=\"region\">\n            <div className={clsx(styles['drawer-triggers-wrapper'])} role=\"toolbar\" aria-orientation=\"vertical\">\n              {visibleItems.map((item, index) => {\n                return (\n                  <DrawerTrigger\n                    key={index}\n                    testUtilsClassName={clsx(\n                      testutilStyles['drawers-trigger'],\n                      item.id === TOOLS_DRAWER_ID && testutilStyles['tools-toggle']\n                    )}\n                    ariaExpanded={drawers?.activeDrawerId === item.id}\n                    ariaLabel={item.ariaLabels?.triggerButton}\n                    ariaControls={drawers?.activeDrawerId === item.id ? item.id : undefined}\n                    trigger={item.trigger}\n                    badge={item.badge}\n                    itemId={item.id}\n                    isActive={drawers?.activeDrawerId === item.id}\n                    onClick={() => {\n                      drawers?.items.length !== 1 &&\n                        drawers?.onChange({\n                          activeDrawerId: item.id !== drawers.activeDrawerId ? item.id : undefined,\n                        });\n                    }}\n                  />\n                );\n              })}\n              {overflowItems.length > 0 && (\n                <div className={clsx(styles['drawer-trigger'])}>\n                  <OverflowMenu\n                    ariaLabel={overflowMenuHasBadge ? drawers?.overflowWithBadgeAriaLabel : drawers?.overflowAriaLabel}\n                    items={overflowItems}\n                    onItemClick={({ detail }) => {\n                      drawers?.onChange({\n                        activeDrawerId: detail.id !== drawers.activeDrawerId ? detail.id : undefined,\n                      });\n                    }}\n                  />\n                </div>\n              )}\n            </div>\n          </aside>\n        )}\n      </div>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}