{"ast":null,"code":"import _toConsumableArray from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport { __rest } from \"tslib\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useCallback, useImperativeHandle, useLayoutEffect, useMemo, useRef } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport InternalAttributeEditor from '../attribute-editor/internal';\nimport InternalStatusIndicator from '../status-indicator/internal';\nimport InternalBox from '../box/internal';\nimport { FormFieldError } from '../form-field/internal';\nimport { TagControl, UndoButton } from './internal';\nimport { validate } from './validation';\nimport { findIndex, useMemoizedArray } from './utils';\nimport styles from './styles.css.js';\nimport { applyDisplayName } from '../internal/utils/apply-display-name';\nimport useBaseComponent from '../internal/hooks/use-base-component';\nimport LiveRegion from '../internal/components/live-region';\nimport { useInternalI18n } from '../i18n/context';\nimport { useStableCallback } from '@cloudscape-design/component-toolkit/internal';\nvar isItemRemovable = function isItemRemovable(_ref) {\n  var tag = _ref.tag;\n  return !tag.markedForRemoval;\n};\nvar TagEditor = React.forwardRef(function (_a, ref) {\n  var _b, _c, _d, _e, _f, _g;\n  var _a$tags = _a.tags,\n    tags = _a$tags === void 0 ? [] : _a$tags,\n    i18nStrings = _a.i18nStrings,\n    _a$loading = _a.loading,\n    loading = _a$loading === void 0 ? false : _a$loading,\n    _a$tagLimit = _a.tagLimit,\n    tagLimit = _a$tagLimit === void 0 ? 50 : _a$tagLimit,\n    allowedCharacterPattern = _a.allowedCharacterPattern,\n    keysRequest = _a.keysRequest,\n    valuesRequest = _a.valuesRequest,\n    onChange = _a.onChange,\n    restProps = __rest(_a, [\"tags\", \"i18nStrings\", \"loading\", \"tagLimit\", \"allowedCharacterPattern\", \"keysRequest\", \"valuesRequest\", \"onChange\"]);\n  var baseComponentProps = useBaseComponent('TagEditor');\n  var i18n = useInternalI18n('tag-editor');\n  var remainingTags = tagLimit - tags.filter(function (tag) {\n    return !tag.markedForRemoval;\n  }).length;\n  var attributeEditorRef = useRef(null);\n  var keyInputRefs = useRef([]);\n  var valueInputRefs = useRef([]);\n  var undoButtonRefs = useRef([]);\n  var initialKeyOptionsRef = useRef([]);\n  var keyDirtyStateRef = useRef([]);\n  var focusEventRef = useRef();\n  useLayoutEffect(function () {\n    var _a;\n    (_a = focusEventRef.current) === null || _a === void 0 ? void 0 : _a.apply(undefined);\n    focusEventRef.current = undefined;\n  });\n  var errors = validate(tags, keyDirtyStateRef.current, i18n, i18nStrings, allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined);\n  var internalTags = useMemoizedArray(tags.map(function (tag, i) {\n    return {\n      tag: tag,\n      error: errors[i]\n    };\n  }), function (prev, next) {\n    var _a, _b, _c, _d;\n    return prev.tag === next.tag && ((_a = prev.error) === null || _a === void 0 ? void 0 : _a.key) === ((_b = next.error) === null || _b === void 0 ? void 0 : _b.key) && ((_c = prev.error) === null || _c === void 0 ? void 0 : _c.value) === ((_d = next.error) === null || _d === void 0 ? void 0 : _d.value);\n  });\n  useImperativeHandle(ref, function () {\n    return {\n      focus: function focus() {\n        var _a, _b;\n        var errorIndex = findIndex(internalTags, function (_ref2) {\n          var error = _ref2.error;\n          return (error === null || error === void 0 ? void 0 : error.key) || (error === null || error === void 0 ? void 0 : error.value);\n        });\n        if (errorIndex !== -1) {\n          var refArray = ((_a = internalTags[errorIndex].error) === null || _a === void 0 ? void 0 : _a.key) ? keyInputRefs : valueInputRefs;\n          (_b = refArray.current[errorIndex]) === null || _b === void 0 ? void 0 : _b.focus();\n        }\n      }\n    };\n  }, [internalTags]);\n  var validateAndFire = useCallback(function (newTags) {\n    fireNonCancelableEvent(onChange, {\n      tags: newTags,\n      valid: !validate(newTags, keyDirtyStateRef.current, i18n, i18nStrings, allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined).some(function (error) {\n        return error;\n      })\n    });\n  }, [onChange, i18n, i18nStrings, allowedCharacterPattern]);\n  var onAddButtonClick = function onAddButtonClick() {\n    validateAndFire([].concat(_toConsumableArray(tags), [{\n      key: '',\n      value: '',\n      existing: false\n    }]));\n    focusEventRef.current = function () {\n      var _a;\n      (_a = keyInputRefs.current[tags.length]) === null || _a === void 0 ? void 0 : _a.focus();\n    };\n  };\n  var onRemoveButtonClick = useStableCallback(function (_ref3) {\n    var detail = _ref3.detail;\n    var _a, _b, _c, _d, _e;\n    var existing = tags[detail.itemIndex].existing;\n    validateAndFire([].concat(_toConsumableArray(tags.slice(0, detail.itemIndex)), _toConsumableArray(existing ? [Object.assign(Object.assign({}, tags[detail.itemIndex]), {\n      markedForRemoval: true\n    })] : []), _toConsumableArray(tags.slice(detail.itemIndex + 1))));\n    if (existing) {\n      focusEventRef.current = function () {\n        var _a;\n        (_a = undoButtonRefs.current[detail.itemIndex]) === null || _a === void 0 ? void 0 : _a.focus();\n      };\n    } else {\n      keyDirtyStateRef.current.splice(detail.itemIndex, 1);\n      var nextKey = keyInputRefs.current[detail.itemIndex + 1];\n      if (nextKey) {\n        // if next key is present, focus _current_ key which will be replaced by next after state update\n        (_a = keyInputRefs.current[detail.itemIndex]) === null || _a === void 0 ? void 0 : _a.focus();\n      } else if (detail.itemIndex > 0) {\n        // otherwise focus previous key/value/undo button\n        var previousIsExisting = tags[detail.itemIndex - 1].existing;\n        if (previousIsExisting) {\n          if (tags[detail.itemIndex - 1].markedForRemoval) {\n            (_b = undoButtonRefs.current[detail.itemIndex - 1]) === null || _b === void 0 ? void 0 : _b.focus();\n          } else {\n            (_c = valueInputRefs.current[detail.itemIndex - 1]) === null || _c === void 0 ? void 0 : _c.focus();\n          }\n        } else {\n          (_d = keyInputRefs.current[detail.itemIndex - 1]) === null || _d === void 0 ? void 0 : _d.focus();\n        }\n      } else {\n        // or the 'add' button\n        (_e = attributeEditorRef.current) === null || _e === void 0 ? void 0 : _e.focusAddButton();\n      }\n    }\n  });\n  var onKeyChange = useStableCallback(function (value, row) {\n    keyDirtyStateRef.current[row] = true;\n    validateAndFire([].concat(_toConsumableArray(tags.slice(0, row)), [Object.assign(Object.assign({}, tags[row]), {\n      key: value\n    })], _toConsumableArray(tags.slice(row + 1))));\n  });\n  var onKeyBlur = useStableCallback(function (row) {\n    keyDirtyStateRef.current[row] = true;\n    // Force re-render by providing a new array reference\n    validateAndFire(_toConsumableArray(tags));\n  });\n  var onValueChange = useStableCallback(function (value, row) {\n    validateAndFire([].concat(_toConsumableArray(tags.slice(0, row)), [Object.assign(Object.assign({}, tags[row]), {\n      value: value\n    })], _toConsumableArray(tags.slice(row + 1))));\n  });\n  var onUndoRemoval = useStableCallback(function (row) {\n    validateAndFire([].concat(_toConsumableArray(tags.slice(0, row)), [Object.assign(Object.assign({}, tags[row]), {\n      markedForRemoval: false\n    })], _toConsumableArray(tags.slice(row + 1))));\n    focusEventRef.current = function () {\n      var _a;\n      (_a = attributeEditorRef.current) === null || _a === void 0 ? void 0 : _a.focusRemoveButton(row);\n    };\n  });\n  var definition = useMemo(function () {\n    return [{\n      label: i18n('i18nStrings.keyHeader', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.keyHeader),\n      control: function control(_ref4, row) {\n        var tag = _ref4.tag;\n        return React.createElement(TagControl, {\n          row: row,\n          value: tag.key,\n          readOnly: tag.existing,\n          limit: 200,\n          defaultOptions: [],\n          placeholder: i18n('i18nStrings.keyPlaceholder', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.keyPlaceholder),\n          errorText: i18n('i18nStrings.keysSuggestionError', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.keysSuggestionError),\n          loadingText: i18n('i18nStrings.keysSuggestionLoading', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.keysSuggestionLoading),\n          suggestionText: i18n('i18nStrings.keySuggestion', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.keySuggestion),\n          tooManySuggestionText: i18n('i18nStrings.tooManyKeysSuggestion', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.tooManyKeysSuggestion),\n          enteredTextLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.enteredKeyLabel,\n          clearAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.clearAriaLabel,\n          onRequest: keysRequest,\n          onChange: onKeyChange,\n          onBlur: onKeyBlur,\n          initialOptionsRef: initialKeyOptionsRef,\n          ref: function ref(_ref5) {\n            keyInputRefs.current[row] = _ref5;\n          }\n        });\n      },\n      errorText: function errorText(_ref6) {\n        var error = _ref6.error;\n        return error === null || error === void 0 ? void 0 : error.key;\n      }\n    }, {\n      label: React.createElement(React.Fragment, null, i18n('i18nStrings.valueHeader', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.valueHeader), \" -\", ' ', React.createElement(\"i\", null, i18n('i18nStrings.optional', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.optional))),\n      control: function control(_ref7, row) {\n        var tag = _ref7.tag;\n        var _a;\n        return tag.markedForRemoval ? React.createElement(\"div\", {\n          role: \"alert\"\n        }, React.createElement(InternalBox, {\n          margin: {\n            top: 'xxs'\n          }\n        }, i18n('i18nStrings.undoPrompt', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.undoPrompt), ' ', React.createElement(UndoButton, {\n          onClick: function onClick() {\n            return onUndoRemoval(row);\n          },\n          ref: function ref(elem) {\n            undoButtonRefs.current[row] = elem;\n          }\n        }, i18n('i18nStrings.undoButton', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.undoButton)))) : React.createElement(TagControl, {\n          row: row,\n          value: tag.value,\n          readOnly: false,\n          limit: 200,\n          defaultOptions: (_a = tag.valueSuggestionOptions) !== null && _a !== void 0 ? _a : [],\n          placeholder: i18n('i18nStrings.valuePlaceholder', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.valuePlaceholder),\n          errorText: i18n('i18nStrings.valuesSuggestionError', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.valuesSuggestionError),\n          loadingText: i18n('i18nStrings.valuesSuggestionLoading', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.valuesSuggestionLoading),\n          suggestionText: i18n('i18nStrings.valueSuggestion', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.valueSuggestion),\n          tooManySuggestionText: i18n('i18nStrings.tooManyValuesSuggestion', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.tooManyValuesSuggestion),\n          enteredTextLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.enteredValueLabel,\n          clearAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.clearAriaLabel,\n          filteringKey: tag.key,\n          onRequest: valuesRequest && function (value) {\n            return valuesRequest(tag.key, value);\n          },\n          onChange: onValueChange,\n          ref: function ref(_ref8) {\n            valueInputRefs.current[row] = _ref8;\n          }\n        });\n      },\n      errorText: function errorText(_ref9) {\n        var error = _ref9.error;\n        return error === null || error === void 0 ? void 0 : error.value;\n      }\n    }];\n  }, [i18n, i18nStrings, keysRequest, onKeyChange, onKeyBlur, valuesRequest, onValueChange, onUndoRemoval]);\n  var forwardedI18nStrings = useMemo(function () {\n    return {\n      errorIconAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.errorIconAriaLabel,\n      itemRemovedAriaLive: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.itemRemovedAriaLive,\n      removeButtonAriaLabel: i18n('i18nStrings.removeButtonAriaLabel', (i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.removeButtonAriaLabel) && function (_ref10) {\n        var tag = _ref10.tag;\n        return i18nStrings.removeButtonAriaLabel(tag);\n      }, function (format) {\n        return function (_ref11) {\n          var tag = _ref11.tag;\n          return format({\n            tag__key: tag.key\n          });\n        };\n      })\n    };\n  }, [i18nStrings, i18n]);\n  if (loading) {\n    return React.createElement(\"div\", {\n      className: styles.root,\n      ref: baseComponentProps.__internalRootRef\n    }, React.createElement(InternalStatusIndicator, {\n      className: styles.loading,\n      type: \"loading\"\n    }, React.createElement(LiveRegion, {\n      visible: true\n    }, i18n('i18nStrings.loading', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.loading))));\n  }\n  var baseProps = getBaseProps(restProps);\n  return React.createElement(InternalAttributeEditor, Object.assign({}, baseProps, baseComponentProps, {\n    ref: attributeEditorRef,\n    className: clsx(styles.root, baseProps.className),\n    items: internalTags,\n    isItemRemovable: isItemRemovable,\n    onAddButtonClick: onAddButtonClick,\n    onRemoveButtonClick: onRemoveButtonClick,\n    addButtonText: (_b = i18n('i18nStrings.addButton', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.addButton)) !== null && _b !== void 0 ? _b : '',\n    removeButtonText: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.removeButton,\n    disableAddButton: remainingTags <= 0,\n    empty: i18n('i18nStrings.emptyTags', i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.emptyTags),\n    additionalInfo: remainingTags < 0 ? React.createElement(FormFieldError, {\n      errorIconAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.errorIconAriaLabel\n    }, (_d = i18n('i18nStrings.tagLimitExceeded', (_c = i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.tagLimitExceeded) === null || _c === void 0 ? void 0 : _c.call(i18nStrings, tagLimit), function (format) {\n      return format({\n        tagLimit: tagLimit\n      });\n    })) !== null && _d !== void 0 ? _d : '') : remainingTags === 0 ? (_f = i18n('i18nStrings.tagLimitReached', (_e = i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.tagLimitReached) === null || _e === void 0 ? void 0 : _e.call(i18nStrings, tagLimit), function (format) {\n      return format({\n        tagLimit: tagLimit\n      });\n    })) !== null && _f !== void 0 ? _f : '' : i18n('i18nStrings.tagLimit', (_g = i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.tagLimit) === null || _g === void 0 ? void 0 : _g.call(i18nStrings, remainingTags, tagLimit), function (format) {\n      return format({\n        tagLimitAvailable: \"\".concat(remainingTags === tagLimit),\n        availableTags: remainingTags,\n        tagLimit: tagLimit\n      });\n    }),\n    definition: definition,\n    i18nStrings: forwardedI18nStrings\n  }));\n});\napplyDisplayName(TagEditor, 'TagEditor');\nexport default TagEditor;","map":{"version":3,"mappings":"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","names":["React","useCallback","useImperativeHandle","useLayoutEffect","useMemo","useRef","clsx","getBaseProps","fireNonCancelableEvent","InternalAttributeEditor","InternalStatusIndicator","InternalBox","FormFieldError","TagControl","UndoButton","validate","findIndex","useMemoizedArray","styles","applyDisplayName","useBaseComponent","LiveRegion","useInternalI18n","useStableCallback","isItemRemovable","tag","markedForRemoval","TagEditor","forwardRef","_a","ref","tags","i18nStrings","loading","tagLimit","allowedCharacterPattern","keysRequest","valuesRequest","onChange","restProps","baseComponentProps","i18n","remainingTags","filter","length","attributeEditorRef","keyInputRefs","valueInputRefs","undoButtonRefs","initialKeyOptionsRef","keyDirtyStateRef","focusEventRef","current","apply","undefined","errors","RegExp","internalTags","map","i","error","prev","next","key","value","focus","errorIndex","refArray","validateAndFire","newTags","valid","some","onAddButtonClick","existing","onRemoveButtonClick","detail","itemIndex","slice","splice","nextKey","previousIsExisting","focusAddButton","onKeyChange","row","onKeyBlur","onValueChange","onUndoRemoval","focusRemoveButton","definition","label","keyHeader","control","readOnly","limit","defaultOptions","placeholder","keyPlaceholder","errorText","keysSuggestionError","loadingText","keysSuggestionLoading","suggestionText","keySuggestion","tooManySuggestionText","tooManyKeysSuggestion","enteredTextLabel","enteredKeyLabel","clearAriaLabel","onRequest","onBlur","initialOptionsRef","valueHeader","optional","role","margin","top","undoPrompt","onClick","elem","undoButton","valueSuggestionOptions","valuePlaceholder","valuesSuggestionError","valuesSuggestionLoading","valueSuggestion","tooManyValuesSuggestion","enteredValueLabel","filteringKey","forwardedI18nStrings","errorIconAriaLabel","itemRemovedAriaLive","removeButtonAriaLabel","format","tag__key","className","root","__internalRootRef","type","visible","baseProps","items","addButtonText","addButton","removeButtonText","removeButton","disableAddButton","empty","emptyTags","additionalInfo","tagLimitExceeded","tagLimitReached","tagLimitAvailable","availableTags"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/tag-editor/lib/default/tag-editor/index.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useCallback, useImperativeHandle, useLayoutEffect, useMemo, useRef } from 'react';\nimport clsx from 'clsx';\n\nimport { getBaseProps } from '../internal/base-component';\nimport { fireNonCancelableEvent, NonCancelableCustomEvent } from '../internal/events';\n\nimport { InputProps } from '../input/interfaces';\nimport { AutosuggestProps } from '../autosuggest/interfaces';\nimport { AttributeEditorProps } from '../attribute-editor/interfaces';\nimport InternalAttributeEditor from '../attribute-editor/internal';\nimport InternalStatusIndicator from '../status-indicator/internal';\nimport InternalBox from '../box/internal';\nimport { FormFieldError } from '../form-field/internal';\n\nimport { TagControl, UndoButton } from './internal';\nimport { TagEditorProps } from './interfaces';\nimport { validate, ValidationError } from './validation';\nimport { findIndex, useMemoizedArray } from './utils';\n\nimport styles from './styles.css.js';\nimport { applyDisplayName } from '../internal/utils/apply-display-name';\nimport useBaseComponent from '../internal/hooks/use-base-component';\nimport LiveRegion from '../internal/components/live-region';\nimport { useInternalI18n } from '../i18n/context';\nimport { useStableCallback } from '@cloudscape-design/component-toolkit/internal';\n\nexport { TagEditorProps };\n\ninterface InternalTag {\n  tag: TagEditorProps.Tag;\n  error?: ValidationError;\n}\n\nconst isItemRemovable = ({ tag }: InternalTag) => !tag.markedForRemoval;\n\nconst TagEditor = React.forwardRef(\n  (\n    {\n      tags = [],\n      i18nStrings,\n      loading = false,\n      tagLimit = 50,\n      allowedCharacterPattern,\n      keysRequest,\n      valuesRequest,\n      onChange,\n      ...restProps\n    }: TagEditorProps,\n    ref: React.Ref<TagEditorProps.Ref>\n  ) => {\n    const baseComponentProps = useBaseComponent('TagEditor');\n    const i18n = useInternalI18n('tag-editor');\n\n    const remainingTags = tagLimit - tags.filter(tag => !tag.markedForRemoval).length;\n\n    const attributeEditorRef = useRef<AttributeEditorProps.Ref>(null);\n    const keyInputRefs = useRef<(InputProps.Ref | undefined | null)[]>([]);\n    const valueInputRefs = useRef<(InputProps.Ref | undefined | null)[]>([]);\n    const undoButtonRefs = useRef<(HTMLAnchorElement | undefined | null)[]>([]);\n\n    const initialKeyOptionsRef = useRef<AutosuggestProps.Options>([]);\n    const keyDirtyStateRef = useRef<boolean[]>([]);\n    const focusEventRef = useRef<() => void>();\n\n    useLayoutEffect(() => {\n      focusEventRef.current?.apply(undefined);\n      focusEventRef.current = undefined;\n    });\n\n    const errors = validate(\n      tags,\n      keyDirtyStateRef.current,\n      i18n,\n      i18nStrings,\n      allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined\n    );\n\n    const internalTags = useMemoizedArray(\n      tags.map((tag, i) => ({ tag, error: errors[i] })),\n      (prev, next) => {\n        return prev.tag === next.tag && prev.error?.key === next.error?.key && prev.error?.value === next.error?.value;\n      }\n    );\n\n    useImperativeHandle(\n      ref,\n      () => ({\n        focus() {\n          const errorIndex = findIndex(internalTags, ({ error }) => error?.key || error?.value);\n          if (errorIndex !== -1) {\n            const refArray = internalTags[errorIndex].error?.key ? keyInputRefs : valueInputRefs;\n            refArray.current[errorIndex]?.focus();\n          }\n        },\n      }),\n      [internalTags]\n    );\n\n    const validateAndFire = useCallback(\n      (newTags: ReadonlyArray<TagEditorProps.Tag>) => {\n        fireNonCancelableEvent(onChange, {\n          tags: newTags,\n          valid: !validate(\n            newTags,\n            keyDirtyStateRef.current,\n            i18n,\n            i18nStrings,\n            allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined\n          ).some(error => error),\n        });\n      },\n      [onChange, i18n, i18nStrings, allowedCharacterPattern]\n    );\n\n    const onAddButtonClick = () => {\n      validateAndFire([...tags, { key: '', value: '', existing: false }]);\n      focusEventRef.current = () => {\n        keyInputRefs.current[tags.length]?.focus();\n      };\n    };\n\n    const onRemoveButtonClick = useStableCallback(\n      ({ detail }: NonCancelableCustomEvent<AttributeEditorProps.RemoveButtonClickDetail>) => {\n        const existing = tags[detail.itemIndex].existing;\n        validateAndFire([\n          ...tags.slice(0, detail.itemIndex),\n          ...(existing ? [{ ...tags[detail.itemIndex], markedForRemoval: true }] : []),\n          ...tags.slice(detail.itemIndex + 1),\n        ]);\n        if (existing) {\n          focusEventRef.current = () => {\n            undoButtonRefs.current[detail.itemIndex]?.focus();\n          };\n        } else {\n          keyDirtyStateRef.current.splice(detail.itemIndex, 1);\n          const nextKey = keyInputRefs.current[detail.itemIndex + 1];\n          if (nextKey) {\n            // if next key is present, focus _current_ key which will be replaced by next after state update\n            keyInputRefs.current[detail.itemIndex]?.focus();\n          } else if (detail.itemIndex > 0) {\n            // otherwise focus previous key/value/undo button\n            const previousIsExisting = tags[detail.itemIndex - 1].existing;\n            if (previousIsExisting) {\n              if (tags[detail.itemIndex - 1].markedForRemoval) {\n                undoButtonRefs.current[detail.itemIndex - 1]?.focus();\n              } else {\n                valueInputRefs.current[detail.itemIndex - 1]?.focus();\n              }\n            } else {\n              keyInputRefs.current[detail.itemIndex - 1]?.focus();\n            }\n          } else {\n            // or the 'add' button\n            attributeEditorRef.current?.focusAddButton();\n          }\n        }\n      }\n    );\n\n    const onKeyChange = useStableCallback((value: string, row: number) => {\n      keyDirtyStateRef.current[row] = true;\n      validateAndFire([...tags.slice(0, row), { ...tags[row], key: value }, ...tags.slice(row + 1)]);\n    });\n\n    const onKeyBlur = useStableCallback((row: number) => {\n      keyDirtyStateRef.current[row] = true;\n      // Force re-render by providing a new array reference\n      validateAndFire([...tags]);\n    });\n\n    const onValueChange = useStableCallback((value: string, row: number) => {\n      validateAndFire([...tags.slice(0, row), { ...tags[row], value }, ...tags.slice(row + 1)]);\n    });\n\n    const onUndoRemoval = useStableCallback((row: number) => {\n      validateAndFire([...tags.slice(0, row), { ...tags[row], markedForRemoval: false }, ...tags.slice(row + 1)]);\n      focusEventRef.current = () => {\n        attributeEditorRef.current?.focusRemoveButton(row);\n      };\n    });\n\n    const definition = useMemo(\n      () => [\n        {\n          label: i18n('i18nStrings.keyHeader', i18nStrings?.keyHeader),\n          control: ({ tag }: InternalTag, row: number) => (\n            <TagControl\n              row={row}\n              value={tag.key}\n              readOnly={tag.existing}\n              limit={200}\n              defaultOptions={[]}\n              placeholder={i18n('i18nStrings.keyPlaceholder', i18nStrings?.keyPlaceholder)}\n              errorText={i18n('i18nStrings.keysSuggestionError', i18nStrings?.keysSuggestionError)}\n              loadingText={i18n('i18nStrings.keysSuggestionLoading', i18nStrings?.keysSuggestionLoading)}\n              suggestionText={i18n('i18nStrings.keySuggestion', i18nStrings?.keySuggestion)}\n              tooManySuggestionText={i18n('i18nStrings.tooManyKeysSuggestion', i18nStrings?.tooManyKeysSuggestion)}\n              enteredTextLabel={i18nStrings?.enteredKeyLabel}\n              clearAriaLabel={i18nStrings?.clearAriaLabel}\n              onRequest={keysRequest}\n              onChange={onKeyChange}\n              onBlur={onKeyBlur}\n              initialOptionsRef={initialKeyOptionsRef}\n              ref={ref => {\n                keyInputRefs.current[row] = ref;\n              }}\n            />\n          ),\n          errorText: ({ error }: InternalTag) => error?.key,\n        },\n        {\n          label: (\n            <>\n              {i18n('i18nStrings.valueHeader', i18nStrings?.valueHeader)} -{' '}\n              <i>{i18n('i18nStrings.optional', i18nStrings?.optional)}</i>\n            </>\n          ),\n          control: ({ tag }: InternalTag, row: number) =>\n            tag.markedForRemoval ? (\n              <div role=\"alert\">\n                <InternalBox margin={{ top: 'xxs' }}>\n                  {i18n('i18nStrings.undoPrompt', i18nStrings?.undoPrompt)}{' '}\n                  <UndoButton\n                    onClick={() => onUndoRemoval(row)}\n                    ref={elem => {\n                      undoButtonRefs.current[row] = elem;\n                    }}\n                  >\n                    {i18n('i18nStrings.undoButton', i18nStrings?.undoButton)}\n                  </UndoButton>\n                </InternalBox>\n              </div>\n            ) : (\n              <TagControl\n                row={row}\n                value={tag.value}\n                readOnly={false}\n                limit={200}\n                defaultOptions={tag.valueSuggestionOptions ?? []}\n                placeholder={i18n('i18nStrings.valuePlaceholder', i18nStrings?.valuePlaceholder)}\n                errorText={i18n('i18nStrings.valuesSuggestionError', i18nStrings?.valuesSuggestionError)}\n                loadingText={i18n('i18nStrings.valuesSuggestionLoading', i18nStrings?.valuesSuggestionLoading)}\n                suggestionText={i18n('i18nStrings.valueSuggestion', i18nStrings?.valueSuggestion)}\n                tooManySuggestionText={i18n(\n                  'i18nStrings.tooManyValuesSuggestion',\n                  i18nStrings?.tooManyValuesSuggestion\n                )}\n                enteredTextLabel={i18nStrings?.enteredValueLabel}\n                clearAriaLabel={i18nStrings?.clearAriaLabel}\n                filteringKey={tag.key}\n                onRequest={valuesRequest && (value => valuesRequest(tag.key, value))}\n                onChange={onValueChange}\n                ref={ref => {\n                  valueInputRefs.current[row] = ref;\n                }}\n              />\n            ),\n          errorText: ({ error }: InternalTag) => error?.value,\n        },\n      ],\n      [i18n, i18nStrings, keysRequest, onKeyChange, onKeyBlur, valuesRequest, onValueChange, onUndoRemoval]\n    );\n\n    const forwardedI18nStrings = useMemo<AttributeEditorProps.I18nStrings<InternalTag>>(\n      () => ({\n        errorIconAriaLabel: i18nStrings?.errorIconAriaLabel,\n        itemRemovedAriaLive: i18nStrings?.itemRemovedAriaLive,\n        removeButtonAriaLabel: i18n(\n          'i18nStrings.removeButtonAriaLabel',\n          i18nStrings?.removeButtonAriaLabel && (({ tag }) => i18nStrings.removeButtonAriaLabel!(tag)),\n          format =>\n            ({ tag }) =>\n              format({ tag__key: tag.key })\n        ),\n      }),\n      [i18nStrings, i18n]\n    );\n\n    if (loading) {\n      return (\n        <div className={styles.root} ref={baseComponentProps.__internalRootRef}>\n          <InternalStatusIndicator className={styles.loading} type=\"loading\">\n            <LiveRegion visible={true}>{i18n('i18nStrings.loading', i18nStrings?.loading)}</LiveRegion>\n          </InternalStatusIndicator>\n        </div>\n      );\n    }\n\n    const baseProps = getBaseProps(restProps);\n    return (\n      <InternalAttributeEditor<InternalTag>\n        {...baseProps}\n        {...baseComponentProps}\n        ref={attributeEditorRef}\n        className={clsx(styles.root, baseProps.className)}\n        items={internalTags}\n        isItemRemovable={isItemRemovable}\n        onAddButtonClick={onAddButtonClick}\n        onRemoveButtonClick={onRemoveButtonClick}\n        addButtonText={i18n('i18nStrings.addButton', i18nStrings?.addButton) ?? ''}\n        removeButtonText={i18nStrings?.removeButton}\n        disableAddButton={remainingTags <= 0}\n        empty={i18n('i18nStrings.emptyTags', i18nStrings?.emptyTags)}\n        additionalInfo={\n          remainingTags < 0 ? (\n            <FormFieldError errorIconAriaLabel={i18nStrings?.errorIconAriaLabel}>\n              {i18n('i18nStrings.tagLimitExceeded', i18nStrings?.tagLimitExceeded?.(tagLimit), format =>\n                format({ tagLimit })\n              ) ?? ''}\n            </FormFieldError>\n          ) : remainingTags === 0 ? (\n            i18n('i18nStrings.tagLimitReached', i18nStrings?.tagLimitReached?.(tagLimit), format =>\n              format({ tagLimit })\n            ) ?? ''\n          ) : (\n            i18n('i18nStrings.tagLimit', i18nStrings?.tagLimit?.(remainingTags, tagLimit), format =>\n              format({ tagLimitAvailable: `${remainingTags === tagLimit}`, availableTags: remainingTags, tagLimit })\n            )\n          )\n        }\n        definition={definition}\n        i18nStrings={forwardedI18nStrings}\n      />\n    );\n  }\n);\n\napplyDisplayName(TagEditor, 'TagEditor');\nexport default TagEditor;\n"]},"metadata":{},"sourceType":"module"}