{"ast":null,"code":"import _defineProperty from \"/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { __rest } from \"tslib\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { FormFieldContext, useFormFieldContext } from '../internal/context/form-field-context';\nimport { useUniqueId } from '../internal/hooks/use-unique-id';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\nimport InternalGrid from '../grid/internal';\nimport InternalIcon from '../icon/internal';\nimport { getAriaDescribedBy, getGridDefinition, getSlotIds } from './util';\nimport styles from './styles.css.js';\nimport { joinStrings } from '../internal/utils/strings';\nimport { useInternalI18n } from '../i18n/context';\nimport { InfoLinkLabelContext } from '../internal/context/info-link-label-context';\nimport { FunnelMetrics } from '../internal/analytics';\nimport { useFunnel, useFunnelStep, useFunnelSubStep } from '../internal/analytics/hooks/use-funnel';\nimport { DATA_ATTR_FIELD_ERROR, DATA_ATTR_FIELD_LABEL, getFieldSlotSeletor, getNameFromSelector, getSubStepAllSelector } from '../internal/analytics/selectors';\nexport function FormFieldError(_ref) {\n  var id = _ref.id,\n    children = _ref.children,\n    errorIconAriaLabel = _ref.errorIconAriaLabel;\n  var i18n = useInternalI18n('form-field');\n  return React.createElement(\"div\", {\n    id: id,\n    className: styles.error\n  }, React.createElement(\"div\", {\n    className: styles['error-icon-shake-wrapper']\n  }, React.createElement(\"div\", {\n    role: \"img\",\n    \"aria-label\": i18n('i18nStrings.errorIconAriaLabel', errorIconAriaLabel),\n    className: styles['error-icon-scale-wrapper']\n  }, React.createElement(InternalIcon, {\n    name: \"status-warning\",\n    size: \"small\"\n  }))), React.createElement(\"span\", {\n    className: styles.error__message\n  }, children));\n}\nexport function ConstraintText(_ref2) {\n  var id = _ref2.id,\n    hasError = _ref2.hasError,\n    children = _ref2.children;\n  return React.createElement(\"div\", {\n    id: id,\n    className: clsx(styles.constraint, hasError && styles['constraint-has-error'])\n  }, children);\n}\nexport default function InternalFormField(_a) {\n  var _analyticsAttributes;\n  var controlId = _a.controlId,\n    _a$stretch = _a.stretch,\n    stretch = _a$stretch === void 0 ? false : _a$stretch,\n    label = _a.label,\n    info = _a.info,\n    i18nStrings = _a.i18nStrings,\n    children = _a.children,\n    secondaryControl = _a.secondaryControl,\n    description = _a.description,\n    constraintText = _a.constraintText,\n    errorText = _a.errorText,\n    __hideLabel = _a.__hideLabel,\n    _a$__internalRootRef = _a.__internalRootRef,\n    __internalRootRef = _a$__internalRootRef === void 0 ? null : _a$__internalRootRef,\n    _a$__disableGutters = _a.__disableGutters,\n    __disableGutters = _a$__disableGutters === void 0 ? false : _a$__disableGutters,\n    rest = __rest(_a, [\"controlId\", \"stretch\", \"label\", \"info\", \"i18nStrings\", \"children\", \"secondaryControl\", \"description\", \"constraintText\", \"errorText\", \"__hideLabel\", \"__internalRootRef\", \"__disableGutters\"]);\n  var baseProps = getBaseProps(rest);\n  var isRefresh = useVisualRefresh();\n  var instanceUniqueId = useUniqueId('formField');\n  var generatedControlId = controlId || instanceUniqueId;\n  var formFieldId = controlId || generatedControlId;\n  var _useFunnel = useFunnel(),\n    funnelInteractionId = _useFunnel.funnelInteractionId,\n    submissionAttempt = _useFunnel.submissionAttempt,\n    funnelState = _useFunnel.funnelState,\n    errorCount = _useFunnel.errorCount;\n  var _useFunnelStep = useFunnelStep(),\n    stepNumber = _useFunnelStep.stepNumber,\n    stepNameSelector = _useFunnelStep.stepNameSelector;\n  var _useFunnelSubStep = useFunnelSubStep(),\n    subStepSelector = _useFunnelSubStep.subStepSelector,\n    subStepNameSelector = _useFunnelSubStep.subStepNameSelector;\n  var slotIds = getSlotIds(formFieldId, label, description, constraintText, errorText);\n  var ariaDescribedBy = getAriaDescribedBy(slotIds);\n  var gridDefinition = getGridDefinition(stretch, !!secondaryControl, isRefresh);\n  var _useFormFieldContext = useFormFieldContext({}),\n    parentAriaLabelledby = _useFormFieldContext.ariaLabelledby,\n    parentAriaDescribedby = _useFormFieldContext.ariaDescribedby,\n    parentInvalid = _useFormFieldContext.invalid;\n  var contextValuesWithoutControlId = {\n    ariaLabelledby: joinStrings(parentAriaLabelledby, slotIds.label) || undefined,\n    ariaDescribedby: joinStrings(parentAriaDescribedby, ariaDescribedBy) || undefined,\n    invalid: !!errorText || !!parentInvalid\n  };\n  var analyticsAttributes = (_analyticsAttributes = {}, _defineProperty(_analyticsAttributes, DATA_ATTR_FIELD_LABEL, slotIds.label ? getFieldSlotSeletor(slotIds.label) : undefined), _defineProperty(_analyticsAttributes, DATA_ATTR_FIELD_ERROR, slotIds.error ? getFieldSlotSeletor(slotIds.error) : undefined), _analyticsAttributes);\n  useEffect(function () {\n    var _a, _b, _c;\n    if (funnelInteractionId && errorText && funnelState.current !== 'complete') {\n      var stepName = getNameFromSelector(stepNameSelector);\n      var subStepName = getNameFromSelector(subStepNameSelector);\n      errorCount.current++;\n      // We don't want to report an error if it is hidden, e.g. inside an Expandable Section.\n      var errorIsVisible = ((_c = (_b = (_a = __internalRootRef === null || __internalRootRef === void 0 ? void 0 : __internalRootRef.current) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect()) === null || _b === void 0 ? void 0 : _b.width) !== null && _c !== void 0 ? _c : 0) > 0;\n      if (errorIsVisible) {\n        FunnelMetrics.funnelSubStepError({\n          funnelInteractionId: funnelInteractionId,\n          subStepSelector: subStepSelector,\n          subStepName: subStepName,\n          subStepNameSelector: subStepNameSelector,\n          stepNumber: stepNumber,\n          stepName: stepName,\n          stepNameSelector: stepNameSelector,\n          fieldErrorSelector: \"\".concat(getFieldSlotSeletor(slotIds.error), \" .\").concat(styles.error__message),\n          fieldLabelSelector: getFieldSlotSeletor(slotIds.label),\n          subStepAllSelector: getSubStepAllSelector()\n        });\n      }\n      return function () {\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        errorCount.current--;\n      };\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [funnelInteractionId, errorText, submissionAttempt, errorCount]);\n  return React.createElement(\"div\", Object.assign({}, baseProps, {\n    className: clsx(baseProps.className, styles.root),\n    ref: __internalRootRef\n  }, analyticsAttributes), React.createElement(\"div\", {\n    className: clsx(__hideLabel && styles['visually-hidden'])\n  }, label && React.createElement(\"label\", {\n    className: styles.label,\n    id: slotIds.label,\n    htmlFor: generatedControlId\n  }, label), React.createElement(InfoLinkLabelContext.Provider, {\n    value: slotIds.label\n  }, !__hideLabel && info && React.createElement(\"span\", {\n    className: styles.info\n  }, info))), description && React.createElement(\"div\", {\n    className: styles.description,\n    id: slotIds.description\n  }, description), React.createElement(\"div\", {\n    className: clsx(styles.controls, __hideLabel && styles['label-hidden'])\n  }, React.createElement(InternalGrid, {\n    gridDefinition: gridDefinition,\n    disableGutters: __disableGutters\n  }, React.createElement(FormFieldContext.Provider, {\n    value: Object.assign({\n      controlId: generatedControlId\n    }, contextValuesWithoutControlId)\n  }, children && React.createElement(\"div\", {\n    className: styles.control\n  }, children)), secondaryControl && React.createElement(FormFieldContext.Provider, {\n    value: contextValuesWithoutControlId\n  }, React.createElement(\"div\", {\n    className: styles['secondary-control']\n  }, secondaryControl)))), (constraintText || errorText) && React.createElement(\"div\", {\n    className: styles.hints\n  }, errorText && React.createElement(FormFieldError, {\n    id: slotIds.error,\n    errorIconAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.errorIconAriaLabel\n  }, errorText), constraintText && React.createElement(ConstraintText, {\n    id: slotIds.constraint,\n    hasError: !!errorText\n  }, constraintText)));\n}","map":{"version":3,"mappings":"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","names":["React","useEffect","clsx","getBaseProps","FormFieldContext","useFormFieldContext","useUniqueId","useVisualRefresh","InternalGrid","InternalIcon","getAriaDescribedBy","getGridDefinition","getSlotIds","styles","joinStrings","useInternalI18n","InfoLinkLabelContext","FunnelMetrics","useFunnel","useFunnelStep","useFunnelSubStep","DATA_ATTR_FIELD_ERROR","DATA_ATTR_FIELD_LABEL","getFieldSlotSeletor","getNameFromSelector","getSubStepAllSelector","FormFieldError","id","children","errorIconAriaLabel","i18n","className","error","role","name","size","error__message","ConstraintText","hasError","constraint","InternalFormField","_a","controlId","stretch","label","info","i18nStrings","secondaryControl","description","constraintText","errorText","__hideLabel","__internalRootRef","__disableGutters","rest","baseProps","isRefresh","instanceUniqueId","generatedControlId","formFieldId","funnelInteractionId","submissionAttempt","funnelState","errorCount","stepNumber","stepNameSelector","subStepSelector","subStepNameSelector","slotIds","ariaDescribedBy","gridDefinition","parentAriaLabelledby","ariaLabelledby","parentAriaDescribedby","ariaDescribedby","parentInvalid","invalid","contextValuesWithoutControlId","undefined","analyticsAttributes","current","stepName","subStepName","errorIsVisible","getBoundingClientRect","width","funnelSubStepError","fieldErrorSelector","fieldLabelSelector","subStepAllSelector","root","ref","htmlFor","Provider","value","controls","disableGutters","control","hints"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/form-field/lib/default/form-field/internal.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect } from 'react';\nimport clsx from 'clsx';\n\nimport { getBaseProps } from '../internal/base-component';\nimport { FormFieldContext, useFormFieldContext } from '../internal/context/form-field-context';\nimport { useUniqueId } from '../internal/hooks/use-unique-id';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\n\nimport InternalGrid from '../grid/internal';\nimport InternalIcon from '../icon/internal';\nimport { getAriaDescribedBy, getGridDefinition, getSlotIds } from './util';\n\nimport styles from './styles.css.js';\nimport { InternalFormFieldProps } from './interfaces';\nimport { joinStrings } from '../internal/utils/strings';\nimport { useInternalI18n } from '../i18n/context';\nimport { InfoLinkLabelContext } from '../internal/context/info-link-label-context';\n\nimport { FunnelMetrics } from '../internal/analytics';\nimport { useFunnel, useFunnelStep, useFunnelSubStep } from '../internal/analytics/hooks/use-funnel';\nimport {\n  DATA_ATTR_FIELD_ERROR,\n  DATA_ATTR_FIELD_LABEL,\n  getFieldSlotSeletor,\n  getNameFromSelector,\n  getSubStepAllSelector,\n} from '../internal/analytics/selectors';\n\ninterface FormFieldErrorProps {\n  id?: string;\n  children?: React.ReactNode;\n  errorIconAriaLabel?: string;\n}\n\nexport function FormFieldError({ id, children, errorIconAriaLabel }: FormFieldErrorProps) {\n  const i18n = useInternalI18n('form-field');\n\n  return (\n    <div id={id} className={styles.error}>\n      <div className={styles['error-icon-shake-wrapper']}>\n        <div\n          role=\"img\"\n          aria-label={i18n('i18nStrings.errorIconAriaLabel', errorIconAriaLabel)}\n          className={styles['error-icon-scale-wrapper']}\n        >\n          <InternalIcon name=\"status-warning\" size=\"small\" />\n        </div>\n      </div>\n      <span className={styles.error__message}>{children}</span>\n    </div>\n  );\n}\n\nexport function ConstraintText({\n  id,\n  hasError,\n  children,\n}: {\n  id?: string;\n  hasError: boolean;\n  children: React.ReactNode;\n}) {\n  return (\n    <div id={id} className={clsx(styles.constraint, hasError && styles['constraint-has-error'])}>\n      {children}\n    </div>\n  );\n}\n\nexport default function InternalFormField({\n  controlId,\n  stretch = false,\n  label,\n  info,\n  i18nStrings,\n  children,\n  secondaryControl,\n  description,\n  constraintText,\n  errorText,\n  __hideLabel,\n  __internalRootRef = null,\n  __disableGutters = false,\n  ...rest\n}: InternalFormFieldProps) {\n  const baseProps = getBaseProps(rest);\n  const isRefresh = useVisualRefresh();\n\n  const instanceUniqueId = useUniqueId('formField');\n  const generatedControlId = controlId || instanceUniqueId;\n  const formFieldId = controlId || generatedControlId;\n\n  const { funnelInteractionId, submissionAttempt, funnelState, errorCount } = useFunnel();\n  const { stepNumber, stepNameSelector } = useFunnelStep();\n  const { subStepSelector, subStepNameSelector } = useFunnelSubStep();\n\n  const slotIds = getSlotIds(formFieldId, label, description, constraintText, errorText);\n\n  const ariaDescribedBy = getAriaDescribedBy(slotIds);\n\n  const gridDefinition = getGridDefinition(stretch, !!secondaryControl, isRefresh);\n\n  const {\n    ariaLabelledby: parentAriaLabelledby,\n    ariaDescribedby: parentAriaDescribedby,\n    invalid: parentInvalid,\n  } = useFormFieldContext({});\n\n  const contextValuesWithoutControlId = {\n    ariaLabelledby: joinStrings(parentAriaLabelledby, slotIds.label) || undefined,\n    ariaDescribedby: joinStrings(parentAriaDescribedby, ariaDescribedBy) || undefined,\n    invalid: !!errorText || !!parentInvalid,\n  };\n\n  const analyticsAttributes = {\n    [DATA_ATTR_FIELD_LABEL]: slotIds.label ? getFieldSlotSeletor(slotIds.label) : undefined,\n    [DATA_ATTR_FIELD_ERROR]: slotIds.error ? getFieldSlotSeletor(slotIds.error) : undefined,\n  };\n\n  useEffect(() => {\n    if (funnelInteractionId && errorText && funnelState.current !== 'complete') {\n      const stepName = getNameFromSelector(stepNameSelector);\n      const subStepName = getNameFromSelector(subStepNameSelector);\n\n      errorCount.current++;\n\n      // We don't want to report an error if it is hidden, e.g. inside an Expandable Section.\n      const errorIsVisible = (__internalRootRef?.current?.getBoundingClientRect()?.width ?? 0) > 0;\n\n      if (errorIsVisible) {\n        FunnelMetrics.funnelSubStepError({\n          funnelInteractionId,\n          subStepSelector,\n          subStepName,\n          subStepNameSelector,\n          stepNumber,\n          stepName,\n          stepNameSelector,\n          fieldErrorSelector: `${getFieldSlotSeletor(slotIds.error)} .${styles.error__message}`,\n          fieldLabelSelector: getFieldSlotSeletor(slotIds.label),\n          subStepAllSelector: getSubStepAllSelector(),\n        });\n      }\n\n      return () => {\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        errorCount.current--;\n      };\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [funnelInteractionId, errorText, submissionAttempt, errorCount]);\n\n  return (\n    <div\n      {...baseProps}\n      className={clsx(baseProps.className, styles.root)}\n      ref={__internalRootRef}\n      {...analyticsAttributes}\n    >\n      <div className={clsx(__hideLabel && styles['visually-hidden'])}>\n        {label && (\n          <label className={styles.label} id={slotIds.label} htmlFor={generatedControlId}>\n            {label}\n          </label>\n        )}\n        <InfoLinkLabelContext.Provider value={slotIds.label}>\n          {!__hideLabel && info && <span className={styles.info}>{info}</span>}\n        </InfoLinkLabelContext.Provider>\n      </div>\n\n      {description && (\n        <div className={styles.description} id={slotIds.description}>\n          {description}\n        </div>\n      )}\n\n      <div className={clsx(styles.controls, __hideLabel && styles['label-hidden'])}>\n        <InternalGrid gridDefinition={gridDefinition} disableGutters={__disableGutters}>\n          <FormFieldContext.Provider\n            value={{\n              controlId: generatedControlId,\n              ...contextValuesWithoutControlId,\n            }}\n          >\n            {children && <div className={styles.control}>{children}</div>}\n          </FormFieldContext.Provider>\n\n          {secondaryControl && (\n            <FormFieldContext.Provider value={contextValuesWithoutControlId}>\n              <div className={styles['secondary-control']}>{secondaryControl}</div>\n            </FormFieldContext.Provider>\n          )}\n        </InternalGrid>\n      </div>\n\n      {(constraintText || errorText) && (\n        <div className={styles.hints}>\n          {errorText && (\n            <FormFieldError id={slotIds.error} errorIconAriaLabel={i18nStrings?.errorIconAriaLabel}>\n              {errorText}\n            </FormFieldError>\n          )}\n          {constraintText && (\n            <ConstraintText id={slotIds.constraint} hasError={!!errorText}>\n              {constraintText}\n            </ConstraintText>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}