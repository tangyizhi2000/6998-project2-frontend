{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { __rest } from \"tslib\";\nimport React, { useEffect, useRef, useState } from 'react';\nimport InternalButton from '../../button/internal';\nimport styles from './styles.css.js';\nimport { useFormFieldContext } from '../../contexts/form-field';\nimport { useUniqueId } from '../../internal/hooks/use-unique-id';\nimport { joinStrings } from '../../internal/utils/strings';\nimport ScreenreaderOnly from '../../internal/components/screenreader-only';\nimport useForwardFocus from '../../internal/hooks/forward-focus';\nimport clsx from 'clsx';\nexport default React.forwardRef(FileInput);\nfunction FileInput(_a, ref) {\n  var _b;\n  var {\n      accept,\n      ariaRequired,\n      multiple,\n      value,\n      onChange,\n      children\n    } = _a,\n    restProps = __rest(_a, [\"accept\", \"ariaRequired\", \"multiple\", \"value\", \"onChange\", \"children\"]);\n  const uploadInputRef = useRef(null);\n  const uploadButtonLabelId = useUniqueId('upload-button-label');\n  const formFieldContext = useFormFieldContext(restProps);\n  const selfControlId = useUniqueId('upload-input');\n  const controlId = (_b = formFieldContext.controlId) !== null && _b !== void 0 ? _b : selfControlId;\n  useForwardFocus(ref, uploadInputRef);\n  const [isFocused, setIsFocused] = useState(false);\n  const onUploadButtonClick = () => {\n    var _a;\n    return (_a = uploadInputRef.current) === null || _a === void 0 ? void 0 : _a.click();\n  };\n  const onUploadInputFocus = () => setIsFocused(true);\n  const onUploadInputBlur = () => setIsFocused(false);\n  const onUploadInputChange = _ref => {\n    let {\n      target\n    } = _ref;\n    onChange(target.files ? Array.from(target.files) : []);\n  };\n  const nativeAttributes = {\n    'aria-labelledby': joinStrings(formFieldContext.ariaLabelledby, uploadButtonLabelId),\n    'aria-describedby': formFieldContext.ariaDescribedby\n  };\n  if (formFieldContext.invalid) {\n    nativeAttributes['aria-invalid'] = true;\n  }\n  if (ariaRequired) {\n    nativeAttributes['aria-required'] = true;\n  }\n  // Synchronizing component's value with the native file input state.\n  useEffect(() => {\n    // The DataTransfer is not available in jsdom.\n    if (window.DataTransfer) {\n      const dataTransfer = new DataTransfer();\n      for (const file of value) {\n        dataTransfer.items.add(file);\n      }\n      uploadInputRef.current.files = dataTransfer.files;\n    }\n  }, [value]);\n  return React.createElement(\"div\", {\n    className: styles['file-input-container']\n  }, React.createElement(\"input\", Object.assign({\n    id: controlId,\n    ref: uploadInputRef,\n    type: \"file\",\n    hidden: false,\n    multiple: multiple,\n    accept: accept,\n    onChange: onUploadInputChange,\n    onFocus: onUploadInputFocus,\n    onBlur: onUploadInputBlur,\n    className: styles['upload-input']\n  }, nativeAttributes)), React.createElement(InternalButton, {\n    iconName: \"upload\",\n    formAction: \"none\",\n    onClick: onUploadButtonClick,\n    className: clsx(styles['upload-button'], isFocused && styles['force-focus-outline']),\n    __nativeAttributes: {\n      tabIndex: -1,\n      'aria-hidden': true\n    }\n  }, children), React.createElement(ScreenreaderOnly, {\n    id: uploadButtonLabelId\n  }, children));\n}","map":{"version":3,"mappings":"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","names":["React","useEffect","useRef","useState","InternalButton","styles","useFormFieldContext","useUniqueId","joinStrings","ScreenreaderOnly","useForwardFocus","clsx","forwardRef","FileInput","_a","ref","accept","ariaRequired","multiple","value","onChange","children","restProps","uploadInputRef","uploadButtonLabelId","formFieldContext","selfControlId","controlId","isFocused","setIsFocused","onUploadButtonClick","current","click","onUploadInputFocus","onUploadInputBlur","onUploadInputChange","target","files","Array","from","nativeAttributes","ariaLabelledby","ariaDescribedby","invalid","window","DataTransfer","dataTransfer","file","items","add","className","id","type","hidden","onFocus","onBlur","iconName","formAction","onClick","__nativeAttributes","tabIndex"],"sources":["/Users/tangyizhi/Desktop/Assignment2/frontend/node_modules/@cloudscape-design/components/file-upload/file-input/lib/default/file-upload/file-input/index.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport React, { ChangeEvent, ForwardedRef, useEffect, useRef, useState } from 'react';\n\nimport InternalButton from '../../button/internal';\nimport styles from './styles.css.js';\nimport { useFormFieldContext } from '../../contexts/form-field';\nimport { useUniqueId } from '../../internal/hooks/use-unique-id';\nimport { FormFieldValidationControlProps } from '../../internal/context/form-field-context';\nimport { joinStrings } from '../../internal/utils/strings';\nimport ScreenreaderOnly from '../../internal/components/screenreader-only';\nimport { FileUploadProps } from '../interfaces';\nimport useForwardFocus from '../../internal/hooks/forward-focus';\nimport clsx from 'clsx';\n\ninterface FileInputProps extends FormFieldValidationControlProps {\n  accept?: string;\n  ariaRequired?: boolean;\n  multiple: boolean;\n  value: readonly File[];\n  onChange: (files: File[]) => void;\n  children: React.ReactNode;\n}\n\nexport default React.forwardRef(FileInput);\n\nfunction FileInput(\n  { accept, ariaRequired, multiple, value, onChange, children, ...restProps }: FileInputProps,\n  ref: ForwardedRef<FileUploadProps.Ref>\n) {\n  const uploadInputRef = useRef<HTMLInputElement>(null);\n  const uploadButtonLabelId = useUniqueId('upload-button-label');\n  const formFieldContext = useFormFieldContext(restProps);\n  const selfControlId = useUniqueId('upload-input');\n  const controlId = formFieldContext.controlId ?? selfControlId;\n\n  useForwardFocus(ref, uploadInputRef);\n\n  const [isFocused, setIsFocused] = useState(false);\n\n  const onUploadButtonClick = () => uploadInputRef.current?.click();\n\n  const onUploadInputFocus = () => setIsFocused(true);\n\n  const onUploadInputBlur = () => setIsFocused(false);\n\n  const onUploadInputChange = ({ target }: ChangeEvent<HTMLInputElement>) => {\n    onChange(target.files ? Array.from(target.files) : []);\n  };\n\n  const nativeAttributes: Record<string, any> = {\n    'aria-labelledby': joinStrings(formFieldContext.ariaLabelledby, uploadButtonLabelId),\n    'aria-describedby': formFieldContext.ariaDescribedby,\n  };\n  if (formFieldContext.invalid) {\n    nativeAttributes['aria-invalid'] = true;\n  }\n  if (ariaRequired) {\n    nativeAttributes['aria-required'] = true;\n  }\n\n  // Synchronizing component's value with the native file input state.\n  useEffect(() => {\n    // The DataTransfer is not available in jsdom.\n    if (window.DataTransfer) {\n      const dataTransfer = new DataTransfer();\n      for (const file of value) {\n        dataTransfer.items.add(file);\n      }\n      uploadInputRef.current!.files = dataTransfer.files;\n    }\n  }, [value]);\n\n  return (\n    <div className={styles['file-input-container']}>\n      {/* This is the actual interactive and accessible file-upload element. */}\n      {/* It is visually hidden to achieve the desired UX design. */}\n      <input\n        id={controlId}\n        ref={uploadInputRef}\n        type=\"file\"\n        hidden={false}\n        multiple={multiple}\n        accept={accept}\n        onChange={onUploadInputChange}\n        onFocus={onUploadInputFocus}\n        onBlur={onUploadInputBlur}\n        className={styles['upload-input']}\n        {...nativeAttributes}\n      />\n\n      {/* The button is decorative. It dispatches clicks to the file input and is ARIA-hidden. */}\n      {/* When the input is focused the focus outline is forced on the button. */}\n      <InternalButton\n        iconName=\"upload\"\n        formAction=\"none\"\n        onClick={onUploadButtonClick}\n        className={clsx(styles['upload-button'], isFocused && styles['force-focus-outline'])}\n        __nativeAttributes={{ tabIndex: -1, 'aria-hidden': true }}\n      >\n        {children}\n      </InternalButton>\n\n      {/* The file input needs to be labelled with provided content. Can't use the button because it is ARIA-hidden. */}\n      <ScreenreaderOnly id={uploadButtonLabelId}>{children}</ScreenreaderOnly>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}